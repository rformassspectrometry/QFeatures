<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create precursor identfiers — createPrecursorId • QFeatures</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create precursor identfiers — createPrecursorId"><meta name="description" content="The createPrecursorId() is used to create new precursor identifier columns
in a QFeatures object's assays (more precisely in their rowData). The new
variable is called by default &quot;Precursor.Id&quot;, and is generated by the
concatenation of other rowData variables that, together, should create
unique identifiers.
These precursor identifiers, assuming their are unique, can then be used to
join assays using joinAssays(), rather than using the rownames, as
illustrated below."><meta property="og:description" content="The createPrecursorId() is used to create new precursor identifier columns
in a QFeatures object's assays (more precisely in their rowData). The new
variable is called by default &quot;Precursor.Id&quot;, and is generated by the
concatenation of other rowData variables that, together, should create
unique identifiers.
These precursor identifiers, assuming their are unique, can then be used to
join assays using joinAssays(), rather than using the rownames, as
illustrated below."><meta property="og:image" content="https://rformassspectrometry.github.io/QFeatures/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">QFeatures</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.19.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/QFeatures.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Processing.html">Processing quantitative proteomics data with QFeatures</a></li>
    <li><a class="dropdown-item" href="../articles/read_QFeatures.html">Load mass spectrometry-based proteomics data using `readQFeatures()`</a></li>
    <li><a class="dropdown-item" href="../articles/Visualization.html">Data visualization from a QFeatures object</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rformassspectrometry/QFeatures/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create precursor identfiers</h1>
      <small class="dont-index">Source: <a href="https://github.com/rformassspectrometry/QFeatures/blob/master/R/QFeatures-functions.R" class="external-link"><code>R/QFeatures-functions.R</code></a></small>
      <div class="d-none name"><code>createPrecursorId.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>createPrecursorId()</code> is used to create new precursor identifier columns
in a <code>QFeatures</code> object's assays (more precisely in their rowData). The new
variable is called by default <code>"Precursor.Id"</code>, and is generated by the
concatenation of other rowData variables that, together, should create
unique identifiers.</p>
<p>These precursor identifiers, assuming their are unique, can then be used to
join assays using <code><a href="joinAssays.html">joinAssays()</a></code>, rather than using the rownames, as
illustrated below.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">createPrecursorId</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"Precursor.Id"</span>,</span>
<span>  fcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Modified.Sequence"</span>, <span class="st">"Precursor.Charge"</span><span class="op">)</span>,</span>
<span>  i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An instance of class <code>QFeatures</code>.</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p><code>character(1)</code> with the name of the new rowData
variable. Default in <code>"Precursor.Id"</code>.</p></dd>


<dt id="arg-fcols">fcols<a class="anchor" aria-label="anchor" href="#arg-fcols"></a></dt>
<dd><p><code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> with the rowData variables names that need to be
<code><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0()</a></code>ed together to create the new <code>name</code> variable. Default is
<code>c("Modified.Sequence", "Precursor.Charge")</code>. Note that these must be
present in <em>all</em> assays.</p></dd>


<dt id="arg-i">i<a class="anchor" aria-label="anchor" href="#arg-i"></a></dt>
<dd><p>The assays of <code>object</code> whose rowData need to be updated. By
default, all assays are considered.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An updated <code>QFeatures</code> instance.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Laurent Gatto</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Let use PSM assay of feat3, that don't have any precursor identifiers</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">feat4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">feat4</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class QFeatures (type: bulk) with 2 sets:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] PSM1: SummarizedExperiment with 7 rows and 2 columns </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2] PSM2: SummarizedExperiment with 8 rows and 2 columns </span>
<span class="r-in"><span><span class="fu"><a href="QFeatures-class.html">rowDataNames</a></span><span class="op">(</span><span class="va">feat4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CharacterList of length 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [["PSM1"]] Sequence Protein charge</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [["PSM2"]] Sequence Protein charge</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create precursor identifiers by concatenating the charge and the</span></span></span>
<span class="r-in"><span><span class="co">## sequencing</span></span></span>
<span class="r-in"><span><span class="va">feat4</span> <span class="op">&lt;-</span> <span class="fu">createPrecursorId</span><span class="op">(</span><span class="va">feat4</span>,</span></span>
<span class="r-in"><span>                           name <span class="op">=</span> <span class="st">"Precursor.Id"</span>,</span></span>
<span class="r-in"><span>                           fcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"charge"</span>, <span class="st">"Sequence"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="QFeatures-class.html">rowDataNames</a></span><span class="op">(</span><span class="va">feat4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CharacterList of length 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [["PSM1"]] Sequence Protein charge Precursor.Id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [["PSM2"]] Sequence Protein charge Precursor.Id</span>
<span class="r-in"><span><span class="fu">rowData</span><span class="op">(</span><span class="va">feat4</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sequence"</span>, <span class="st">"charge"</span>, <span class="st">"Precursor.Id"</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 7 rows and 3 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Sequence    charge  Precursor.Id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;character&gt; &lt;numeric&gt;   &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      SYGFNAAR         1     1SYGFNAAR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      SYGFNAAR         1     1SYGFNAAR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      SYGFNAAR         2     2SYGFNAAR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      ELGNDAYK         1     1ELGNDAYK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      ELGNDAYK         2     2ELGNDAYK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      ELGNDAYK         3     3ELGNDAYK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 IAEESNFPFI...         1 1IAEESNFPF...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## As can be seen below, some precursors are duplicated, which will be</span></span></span>
<span class="r-in"><span><span class="co">## problematic when joining the assays. Should we join `1SYGFNAAR` in the</span></span></span>
<span class="r-in"><span><span class="co">## second assay with the first or the second `1SYGFNAAR` in the first assay?</span></span></span>
<span class="r-in"><span><span class="fu">rowData</span><span class="op">(</span><span class="va">feat4</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span>, <span class="st">"Precursor.Id"</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 7 rows and 1 column</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Precursor.Id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1SYGFNAAR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1SYGFNAAR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     2SYGFNAAR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     1ELGNDAYK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     2ELGNDAYK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     3ELGNDAYK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 1IAEESNFPF...</span>
<span class="r-in"><span><span class="fu">rowData</span><span class="op">(</span><span class="va">feat4</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span>, <span class="st">"Precursor.Id"</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 8 rows and 1 column</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Precursor.Id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1SYGFNAAR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1ELGNDAYK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     2ELGNDAYK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     3ELGNDAYK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 1IAEESNFPF...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 1IAEESNFPF...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 2IAEESNFPF...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 3IAEESNFPF...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Here, one can either aggregate PSMs into PSMs with unique identifers (see</span></span></span>
<span class="r-in"><span><span class="co">## ?aggregateFeatures) or remove duplicated entries.</span></span></span>
<span class="r-in"><span><span class="fu">nrows</span><span class="op">(</span><span class="va">feat4</span><span class="op">)</span> <span class="co">## before filtering</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM1 PSM2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    7    8 </span>
<span class="r-in"><span><span class="va">feat4</span> <span class="op">&lt;-</span> <span class="fu"><a href="QFeatures-filtering.html">filterFeatures</a></span><span class="op">(</span><span class="va">feat4</span>, <span class="op">~</span> <span class="op">!</span><span class="fu"><a href="QFeatures-filtering.html">isDuplicated</a></span><span class="op">(</span><span class="va">Precursor.Id</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 'Precursor.Id' found in 2 out of 2 assay(s).</span>
<span class="r-in"><span><span class="fu">nrows</span><span class="op">(</span><span class="va">feat4</span><span class="op">)</span> <span class="co">## after filtering</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM1 PSM2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5    6 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The assays can now be joined, using the newly created identifier rather</span></span></span>
<span class="r-in"><span><span class="co">## than the (default) rownames.</span></span></span>
<span class="r-in"><span><span class="va">feat4</span> <span class="op">&lt;-</span> <span class="fu"><a href="joinAssays.html">joinAssays</a></span><span class="op">(</span><span class="va">feat4</span>, i <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>                    name <span class="op">=</span> <span class="st">"Precursors"</span>,</span></span>
<span class="r-in"><span>                    fcol <span class="op">=</span> <span class="st">"Precursor.Id"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 'Precursor.Id' to join assays.</span>
<span class="r-in"><span><span class="va">feat4</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class QFeatures (type: bulk) with 3 sets:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] PSM1: SummarizedExperiment with 5 rows and 2 columns </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2] PSM2: SummarizedExperiment with 6 rows and 2 columns </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3] Precursors: SummarizedExperiment with 8 rows and 4 columns </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Laurent Gatto, Christophe Vanderaa.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer></div>





  </body></html>

