<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Join assays in a QFeatures object — joinAssays • QFeatures</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Join assays in a QFeatures object — joinAssays"><meta name="description" content="This function applies a full-join type of operation on 2 or more
assays in a QFeatures instance."><meta property="og:description" content="This function applies a full-join type of operation on 2 or more
assays in a QFeatures instance."><meta property="og:image" content="https://rformassspectrometry.github.io/QFeatures/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">QFeatures</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.19.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/QFeatures.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Processing.html">Processing quantitative proteomics data with QFeatures</a></li>
    <li><a class="dropdown-item" href="../articles/read_QFeatures.html">Load mass spectrometry-based proteomics data using `readQFeatures()`</a></li>
    <li><a class="dropdown-item" href="../articles/Visualization.html">Data visualization from a QFeatures object</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RforMassSpectrometry/QFeatures/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Join assays in a QFeatures object</h1>
      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/QFeatures/blob/master/R/QFeatures-join.R" class="external-link"><code>R/QFeatures-join.R</code></a></small>
      <div class="d-none name"><code>joinAssays.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function applies a full-join type of operation on 2 or more
assays in a <code>QFeatures</code> instance.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">joinAssays</span><span class="op">(</span><span class="va">x</span>, <span class="va">i</span>, name <span class="op">=</span> <span class="st">"joinedAssay"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An instance of class <a href="QFeatures-class.html">QFeatures</a>.</p></dd>


<dt id="arg-i">i<a class="anchor" aria-label="anchor" href="#arg-i"></a></dt>
<dd><p>The indices or names of al least two assays to be joined.</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>A <code>character(1)</code> naming the new assay. Default is
<code>joinedAssay</code>. Note that the function will fail if there's
already an assay with <code>name</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>QFeatures</code> object with an additional assay.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The rows to be joined are chosen based on the rownames of the
respective assays. It is the user's responsability to make sure
these are meaningful, such as for example refering to unique
peptide sequences or proteins.</p>
<p>The join operation acts along the rows and expects the samples
(columns) of the assays to be disjoint, i.e. the assays mustn't
share any samples. Rows that aren't present in an assay are set to
<code>NA</code> when merged.</p>
<p>The <code>rowData</code> slots are also joined. However, only columns that
are shared and that have the same values for matching columns/rows
are retained. For example of a feature variable <code>A</code> in sample <code>S1</code>
contains value <code>a1</code> and variable <code>A</code> in sample <code>S2</code> in a different
assay contains <code>a2</code>, then the feature variable <code>A</code> is dropped in
the merged assay.</p>
<p>The joined assay is linked to its parent assays through an <code>AssayLink</code>
object. The link between the child assay and the parent assays is based on
the assay row names, just like the procedure for joining the parent assays.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Laurent Gatto</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## -----------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## An example QFeatures with 3 assays to be joined</span></span></span>
<span class="r-in"><span><span class="co">## -----------------------------------------------</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">feat2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">feat2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class QFeatures (type: bulk) with 3 sets:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] assay1: SummarizedExperiment with 10 rows and 4 columns </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2] assay2: SummarizedExperiment with 4 rows and 4 columns </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3] assay3: SummarizedExperiment with 7 rows and 4 columns </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">feat2</span> <span class="op">&lt;-</span> <span class="fu">joinAssays</span><span class="op">(</span><span class="va">feat2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Individual assays to be joined, each with 4 samples and a</span></span></span>
<span class="r-in"><span><span class="co">## variable number of rows.</span></span></span>
<span class="r-in"><span><span class="fu">assay</span><span class="op">(</span><span class="va">feat2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   S1 S2 S3 S4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a  1 11 21 31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b  2 12 22 32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c  3 13 23 33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d  4 14 24 34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e  5 15 25 35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f  6 16 26 36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g  7 17 27 37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h  8 18 28 38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i  9 19 29 39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j 10 20 30 40</span>
<span class="r-in"><span><span class="fu">assay</span><span class="op">(</span><span class="va">feat2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   S5 S6 S7 S8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h  1  5  9 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i  2  6 10 14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j  3  7 11 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k  4  8 12 16</span>
<span class="r-in"><span><span class="fu">assay</span><span class="op">(</span><span class="va">feat2</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   S9 S10 S11 S12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a  1   8  15  22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b  2   9  16  23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j  3  10  17  24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k  4  11  18  25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> l  5  12  19  26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m  6  13  20  27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n  7  14  21  28</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The joined assay contains 14 rows (corresponding to the union</span></span></span>
<span class="r-in"><span><span class="co">## of those in the initial assays) and 12 samples</span></span></span>
<span class="r-in"><span><span class="fu">assay</span><span class="op">(</span><span class="va">feat2</span><span class="op">[[</span><span class="st">"joinedAssay"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 S12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j 10 20 30 40  3  7 11 15  3  10  17  24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a  1 11 21 31 NA NA NA NA  1   8  15  22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b  2 12 22 32 NA NA NA NA  2   9  16  23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k NA NA NA NA  4  8 12 16  4  11  18  25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h  8 18 28 38  1  5  9 13 NA  NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i  9 19 29 39  2  6 10 14 NA  NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d  4 14 24 34 NA NA NA NA NA  NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e  5 15 25 35 NA NA NA NA NA  NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f  6 16 26 36 NA NA NA NA NA  NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c  3 13 23 33 NA NA NA NA NA  NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g  7 17 27 37 NA NA NA NA NA  NA  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> l NA NA NA NA NA NA NA NA  5  12  19  26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m NA NA NA NA NA NA NA NA  6  13  20  27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n NA NA NA NA NA NA NA NA  7  14  21  28</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The individual rowData to be joined.</span></span></span>
<span class="r-in"><span><span class="fu">rowData</span><span class="op">(</span><span class="va">feat2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 10 rows and 2 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Prot         x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;character&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a          Pa  2.067646</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b          Pb -0.188981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c          Pc  0.266870</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d          Pd  1.671331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e          Pe -1.857170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f          Pf  1.166811</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g          Pg  0.316521</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h          Ph  0.976154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i          Pi  0.117673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j          Pj  2.420734</span>
<span class="r-in"><span><span class="fu">rowData</span><span class="op">(</span><span class="va">feat2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 4 rows and 3 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Prot          x         y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;character&gt;  &lt;numeric&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h          Ph -0.0463617  1.547125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i          Pi  0.6833728 -1.513248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j          Pj  0.7917619  0.574492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k          Pk -0.5226943  1.404666</span>
<span class="r-in"><span><span class="fu">rowData</span><span class="op">(</span><span class="va">feat2</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 7 rows and 3 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Prot          x         y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;character&gt;  &lt;numeric&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a          Pa -0.0762406 -0.420478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b          Pb  0.5580027 -0.389534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j          Pj  2.5905327 -0.377114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k          Pk  0.1605870 -0.418806</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> l          Pl  0.7486858  1.967733</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m          Pm  1.2365642 -0.516798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n          Pn -0.4848651  0.263387</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Only the 'Prot' variable is retained because it is shared among</span></span></span>
<span class="r-in"><span><span class="co">## all assays and the values and coherent across samples (the</span></span></span>
<span class="r-in"><span><span class="co">## value of 'Prot' for row 'j' is always 'Pj'). The variable 'y' is</span></span></span>
<span class="r-in"><span><span class="co">## missing in 'assay1' and while variable 'x' is present is all</span></span></span>
<span class="r-in"><span><span class="co">## assays, the values for the shared rows are different.</span></span></span>
<span class="r-in"><span><span class="fu">rowData</span><span class="op">(</span><span class="va">feat2</span><span class="op">[[</span><span class="st">"joinedAssay"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 14 rows and 1 column</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Prot</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j            Pj</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a            Pa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b            Pb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k            Pk</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h            Ph</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...         ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c            Pc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g            Pg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> l            Pl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m            Pm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n            Pn</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Laurent Gatto, Christophe Vanderaa.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer></div>





  </body></html>

