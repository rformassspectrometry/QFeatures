<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Links between Assays — AssayLinks • QFeatures</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Links between Assays — AssayLinks"><meta property="og:description" content="Links between assays within a QFeatures object are handled by an
AssayLinks object. It is composed by a list of AssayLink
instances."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">QFeatures</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.11.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/QFeatures.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Processing.html">Processing quantitative proteomics data with QFeatures</a>
    </li>
    <li>
      <a href="../articles/Visualization.html">Data visualization from a QFeatures object</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/RforMassSpectrometry/QFeatures/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Links between Assays</h1>
    <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/QFeatures/blob/HEAD/R/AssayLinks.R" class="external-link"><code>R/AssayLinks.R</code></a></small>
    <div class="hidden name"><code>AssayLinks.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Links between assays within a <a href="QFeatures-class.html">QFeatures</a> object are handled by an
<code>AssayLinks</code> object. It is composed by a list of <code>AssayLink</code>
instances.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre><code># S4 method for AssayLink
show(object)

# S4 method for AssayLinks
updateObject(object, ..., verbose = FALSE)

# S4 method for AssayLink
updateObject(object, ..., verbose = FALSE)

AssayLink(name, from = NA_character_, fcol = NA_character_, hits = Hits())

AssayLinks(..., names = NULL)

assayLink(x, i)

assayLinks(x, i)

# S4 method for AssayLink,character,ANY,ANY
[(x, i, j, ..., drop = TRUE)

# S4 method for AssayLinks,list,ANY,ANY
[(x, i, j, ..., drop = TRUE)

addAssayLink(object, from, to, varFrom, varTo)

addAssayLinkOneToOne(object, from, to)</code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>An <code>AssayLink</code> object to show.</p></dd>


<dt>...</dt>
<dd><p>A set of <code>AssayLink</code> objects or a list thereof.</p></dd>


<dt>verbose</dt>
<dd><p>logical (default FALSE) whether to print extra messages</p></dd>


<dt>name</dt>
<dd><p>A mandatory name of the assay(s).</p></dd>


<dt>from</dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> or <code><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer()</a></code> indicating which
assay(s) to link from in <code>object</code></p></dd>


<dt>fcol</dt>
<dd><p>The feature variable of the parent assay used to
generate the current assay (used in
<code>aggregateFeatures</code>). <code>NA_character_</code>, if not applicable.</p></dd>


<dt>hits</dt>
<dd><p>An object of class <a href="https://rdrr.io/pkg/S4Vectors/man/Hits-class.html" class="external-link">S4Vectors::Hits</a> matching the
features of two assays.</p></dd>


<dt>names</dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> of <code>AssayLink</code> names. If provided,
<code>...</code> are ignored, and <code>names</code> is used to create an
<code>AssayLinks</code> object with <code>AssayLink</code> instances with names
<code>names</code>.</p></dd>


<dt>x</dt>
<dd><p>An instance of class <a href="QFeatures-class.html">QFeatures</a>.</p></dd>


<dt>i</dt>
<dd><p>The index or name of the assay whose <code>AssayLink</code> and
parents <code>AssayLink</code> instances are to be returned. For <code>[</code>, the
feature names to filter on.</p></dd>


<dt>j</dt>
<dd><p>ignored.</p></dd>


<dt>drop</dt>
<dd><p>ignored.</p></dd>


<dt>to</dt>
<dd><p>A <code>character(1)</code> or <code>integer(1)</code> indicating which assay
to link to in <code>object</code></p></dd>


<dt>varFrom</dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> indicating the feature variable(s)
to use to match the <code>from</code> assay(s) to the <code>to</code>
assay. <code>varFrom</code> must have the same length as <code>from</code> and is
assumed to be ordered as <code>from</code>.</p></dd>


<dt>varTo</dt>
<dd><p>A <code>character(1)</code> indicating the feature variable to
use to match the <code>to</code> assay to the <code>from</code> assay(s).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>assayLink</code> returns an instance of class <code>AssayLink</code>.</p>


<p><code>assayLinks</code> returns an instance of class <code>AssayLinks</code>.</p>
    </div>
    <div id="constructors">
    <h2>Constructors</h2>
    


<p>Object can be created with the <code>AssayLink()</code> and <code>AssayLinks()</code>
constructors.</p>
    </div>
    <div id="methods-and-functions">
    <h2>Methods and functions</h2>
    

<ul><li><p><code>assayLink(x, i)</code> accesses the AssayLink at position <code>i</code> or with
name <code>i</code> in the <a href="QFeatures-class.html">QFeatures</a> object <code>x</code>.</p></li>
<li><p><code>parentAssayLinks(x, i, recursive = FALSE)</code> accesses the
parent(s) <code>AssayLinks</code> or assay with index or name <code>i</code>.</p></li>
</ul></div>
    <div id="creating-links-between-assays">
    <h2>Creating links between assays</h2>
    

<ul><li><p><code>addAssayLink</code> takes a parent assay and a child assay contained
in the <a href="QFeatures-class.html">QFeatures</a> object and creates a link given a matching
feature variable in each assay's <code>rowData</code>. <code>addAssayLink</code> also
allows to link an assay from multiple parent assays (see
examples below).</p></li>
<li><p><code>addAssayLinkOneToOne</code> links two assays contained in the
<a href="QFeatures-class.html">QFeatures</a> object. The parent assay and the child assay must
have the same size and contain the same rownames (a different
ordering is allowed). The matching is performed based on the row
names of the assays, instead of a supplied variable name in
<code>rowData</code>. Providing multiple parents is not supported.</p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Creating an AssayLink object</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">al1</span> <span class="op">&lt;-</span> <span class="fu">AssayLink</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"assay1"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">al1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AssayLink for assay &lt;assay1&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [from:NA|fcol:NA|hits:0]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Creating an AssayLinks object</span></span></span>
<span class="r-in"><span><span class="co">##------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">AssayLinks</span><span class="op">(</span><span class="va">al1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AssayLinks of length 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names(1): assay1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">al2</span> <span class="op">&lt;-</span> <span class="fu">AssayLinks</span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Assay1"</span>, <span class="st">"Assay2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">al2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AssayLinks of length 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names(2): Assay1 Assay2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##---------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Adding an AssayLink between two assays</span></span></span>
<span class="r-in"><span><span class="co">##---------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## create a QFeatures object with 2 (identical) assays</span></span></span>
<span class="r-in"><span><span class="co">## see also '?QFeatures'</span></span></span>
<span class="r-in"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu">SummarizedExperiment</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                                  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                                                  <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           rowData <span class="op">=</span> <span class="fu">DataFrame</span><span class="op">(</span>ID <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ft</span> <span class="op">&lt;-</span> <span class="fu"><a href="QFeatures-class.html">QFeatures</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>assay1 <span class="op">=</span> <span class="va">se</span>, assay2 <span class="op">=</span> <span class="va">se</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## assay1 and assay2 are not linked</span></span></span>
<span class="r-in"><span><span class="fu">assayLink</span><span class="op">(</span><span class="va">ft</span>, <span class="st">"assay2"</span><span class="op">)</span> <span class="co">## 'from' is NA</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AssayLink for assay &lt;assay2&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [from:NA|fcol:NA|hits:0]</span>
<span class="r-in"><span><span class="fu">assayLink</span><span class="op">(</span><span class="va">ft</span>, <span class="st">"assay1"</span><span class="op">)</span> <span class="co">## 'from' is NA</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AssayLink for assay &lt;assay1&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [from:NA|fcol:NA|hits:0]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Suppose assay2 was generated from assay1 and the feature variable</span></span></span>
<span class="r-in"><span><span class="co">## 'ID' keeps track of the relationship between the two assays</span></span></span>
<span class="r-in"><span><span class="va">ftLinked</span> <span class="op">&lt;-</span> <span class="fu">addAssayLink</span><span class="op">(</span><span class="va">ft</span>, from <span class="op">=</span> <span class="st">"assay1"</span>, to <span class="op">=</span> <span class="st">"assay2"</span>,</span></span>
<span class="r-in"><span>                         varFrom <span class="op">=</span> <span class="st">"ID"</span>, varTo <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">assayLink</span><span class="op">(</span><span class="va">ftLinked</span>, <span class="st">"assay2"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AssayLink for assay &lt;assay2&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [from:assay1|fcol:ID|hits:10]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## For one-to-one relationships, you can also use</span></span></span>
<span class="r-in"><span><span class="va">ftLinked</span> <span class="op">&lt;-</span> <span class="fu">addAssayLinkOneToOne</span><span class="op">(</span><span class="va">ft</span>, from <span class="op">=</span> <span class="st">"assay1"</span>, to <span class="op">=</span> <span class="st">"assay2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">assayLink</span><span class="op">(</span><span class="va">ftLinked</span>, <span class="st">"assay2"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AssayLink for assay &lt;assay2&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [from:assay1|fcol:._oneToOne|hits:10]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##----------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Adding an AssayLink between more assays</span></span></span>
<span class="r-in"><span><span class="co">##----------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## An assay can also be linked to multiple parent assays</span></span></span>
<span class="r-in"><span><span class="co">## Create a QFeatures object with 2 parent assays and 1 child assay</span></span></span>
<span class="r-in"><span><span class="va">ft</span> <span class="op">&lt;-</span> <span class="fu"><a href="QFeatures-class.html">QFeatures</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>parent1 <span class="op">=</span> <span class="va">se</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="op">]</span>, parent2 <span class="op">=</span> <span class="va">se</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>, child <span class="op">=</span> <span class="va">se</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ft</span> <span class="op">&lt;-</span> <span class="fu">addAssayLink</span><span class="op">(</span><span class="va">ft</span>, from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"parent1"</span>, <span class="st">"parent2"</span><span class="op">)</span>, to <span class="op">=</span> <span class="st">"child"</span>,</span></span>
<span class="r-in"><span>                   varFrom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"ID"</span><span class="op">)</span>, varTo <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">assayLink</span><span class="op">(</span><span class="va">ft</span>, <span class="st">"child"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AssayLink for assay &lt;child&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [from:parent1,parent2|fcol:ID,ID|hits:6,7]</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Laurent Gatto, Christophe Vanderaa.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

