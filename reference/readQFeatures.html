<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>QFeatures from tabular data — readQFeatures • QFeatures</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="QFeatures from tabular data — readQFeatures"><meta name="description" content="These functions convert tabular data into dedicated data
objets. The readSummarizedExperiment() function takes a file
name or data.frame and converts it into a
SummarizedExperiment() object.  The readQFeatures() function
takes a data.frame and converts it into a QFeatures object
(see QFeatures() for details). For the latter, two use-cases
exist:
The single-set case will generate a QFeatures object with a
single SummarizedExperiment containing all features of the
input table.
The multi-set case will generate a QFeatures object containing
multiple SummarizedExperiments, resulting from splitting the
input table. This multi-set case is generally used when the
input table contains data from multiple runs/batches.

"><meta property="og:description" content="These functions convert tabular data into dedicated data
objets. The readSummarizedExperiment() function takes a file
name or data.frame and converts it into a
SummarizedExperiment() object.  The readQFeatures() function
takes a data.frame and converts it into a QFeatures object
(see QFeatures() for details). For the latter, two use-cases
exist:
The single-set case will generate a QFeatures object with a
single SummarizedExperiment containing all features of the
input table.
The multi-set case will generate a QFeatures object containing
multiple SummarizedExperiments, resulting from splitting the
input table. This multi-set case is generally used when the
input table contains data from multiple runs/batches.

"><meta property="og:image" content="https://rformassspectrometry.github.io/QFeatures/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">QFeatures</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.19.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/QFeatures.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Processing.html">Processing quantitative proteomics data with QFeatures</a></li>
    <li><a class="dropdown-item" href="../articles/read_QFeatures.html">Load mass spectrometry-based proteomics data using `readQFeatures()`</a></li>
    <li><a class="dropdown-item" href="../articles/Visualization.html">Data visualization from a QFeatures object</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RforMassSpectrometry/QFeatures/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>QFeatures from tabular data</h1>
      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/QFeatures/blob/master/R/readQFeatures.R" class="external-link"><code>R/readQFeatures.R</code></a></small>
      <div class="d-none name"><code>readQFeatures.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions convert tabular data into dedicated data
objets. The <code>readSummarizedExperiment()</code> function takes a file
name or <code>data.frame</code> and converts it into a
<code>SummarizedExperiment()</code> object.  The <code>readQFeatures()</code> function
takes a <code>data.frame</code> and converts it into a <code>QFeatures</code> object
(see <code><a href="QFeatures-class.html">QFeatures()</a></code> for details). For the latter, two use-cases
exist:</p><ul><li><p>The single-set case will generate a <code>QFeatures</code> object with a
single <code>SummarizedExperiment</code> containing all features of the
input table.</p></li>
<li><p>The multi-set case will generate a <code>QFeatures</code> object containing
multiple <code>SummarizedExperiment</code>s, resulting from splitting the
input table. This multi-set case is generally used when the
input table contains data from multiple runs/batches.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">readSummarizedExperiment</span><span class="op">(</span></span>
<span>  <span class="va">assayData</span>,</span>
<span>  quantCols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fnames <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ecol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">readQFeatures</span><span class="op">(</span></span>
<span>  <span class="va">assayData</span>,</span>
<span>  colData <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quantCols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  runCol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"quants"</span>,</span>
<span>  removeEmptyCols <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ecol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fnames <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-assaydata">assayData<a class="anchor" aria-label="anchor" href="#arg-assaydata"></a></dt>
<dd><p>A <code>data.frame</code>, or any object that can be coerced
into a <code>data.frame</code>, holding the quantitative assay. For
<code>readSummarizedExperiment()</code>, this can also be a
<code>character(1)</code> pointing to a filename. This <code>data.frame</code> is
typically generated by an identification and quantification
software, such as Sage, Proteome Discoverer, MaxQuant, ...</p></dd>


<dt id="arg-quantcols">quantCols<a class="anchor" aria-label="anchor" href="#arg-quantcols"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code>, <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code> or <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>
defining the columns of the <code>assayData</code> that contain the
quantitative data. This information can also be defined in
<code>colData</code> (see details).</p></dd>


<dt id="arg-fnames">fnames<a class="anchor" aria-label="anchor" href="#arg-fnames"></a></dt>
<dd><p>For the single- and multi-set cases, an optional
<code>character(1)</code> or <code>numeric(1)</code> indicating the column to be
used as feature names.  Note that rownames must be unique
within <code>QFeatures</code> sets. Default is <code>NULL</code>.</p></dd>


<dt id="arg-ecol">ecol<a class="anchor" aria-label="anchor" href="#arg-ecol"></a></dt>
<dd><p>Same as <code>quantCols</code>. Available for backwards
compatibility. Default is <code>NULL</code>. If both <code>ecol</code> and <code>colData</code>
are set, an error is thrown.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments that can be passed on to <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv()</a></code>
except <code>stringsAsFactors</code>, which is always <code>FALSE</code>. Only
applicable to <code>readSummarizedExperiment()</code>.</p></dd>


<dt id="arg-coldata">colData<a class="anchor" aria-label="anchor" href="#arg-coldata"></a></dt>
<dd><p>A <code>data.frame</code> (or any object that can be coerced
to a <code>data.frame</code>) containing sample/column annotations,
including <code>quantCols</code> and <code>runCol</code> (see details).</p></dd>


<dt id="arg-runcol">runCol<a class="anchor" aria-label="anchor" href="#arg-runcol"></a></dt>
<dd><p>For the multi-set case, a <code>numeric(1)</code> or
<code>character(1)</code> pointing to the column of <code>assayData</code> (and
<code>colData</code>, is set) that contains the runs/batches. Make sure
that the column name in both tables are identical and
syntactically valid (if you supply a <code>character</code>) or have the
same index (if you supply a <code>numeric</code>). Note that characters
are converted to syntactically valid names using <code>make.names</code></p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>For the single-set case, an optional <code>character(1)</code> to
name the set in the <code>QFeatures</code> object. Default is <code>quants</code>.</p></dd>


<dt id="arg-removeemptycols">removeEmptyCols<a class="anchor" aria-label="anchor" href="#arg-removeemptycols"></a></dt>
<dd><p>A <code>logical(1)</code>. If <code>TRUE</code>, quantitative
columns that contain only missing values are removed.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A <code>logical(1)</code> indicating whether the progress of
the data reading and formatting should be printed to the
console. Default is <code>TRUE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An instance of class <code>QFeatures</code> or
<code><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">SummarizedExperiment::SummarizedExperiment()</a></code>. For the
former, the quantitative sets of each run are stored in
<code><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">SummarizedExperiment::SummarizedExperiment()</a></code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The single- and multi-set cases are defined by the <code>quantCols</code> and
<code>runCol</code> parameters, whether passed by the <code>quantCols</code> and
<code>runCol</code> vectors and/or the <code>colData</code> <code>data.frame</code> (see below).</p><div class="section">
<h3 id="single-set-case">Single-set case<a class="anchor" aria-label="anchor" href="#single-set-case"></a></h3>


<p>The quantitative data variables are defined by the <code>quantCols</code>.
The single-set case can be represented schematically as shown
below.</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="sc">|------+----------------+-----------</span><span class="er">|</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="er">|</span> cols <span class="sc">|</span> quantCols <span class="dv">1</span>..N <span class="sc">|</span> more cols <span class="sc">|</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="er">|</span> .    <span class="sc">|</span> ...            <span class="sc">|</span> ...       <span class="sc">|</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="er">|</span> .    <span class="sc">|</span> ...            <span class="sc">|</span> ...       <span class="sc">|</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="er">|</span> .    <span class="sc">|</span> ...            <span class="sc">|</span> ...       <span class="sc">|</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="er">|</span><span class="sc">------+----------------+-----------</span><span class="er">|</span></span></code></pre><p></p></div>
<p>Note that every <code>quantCols</code> column contains data for a single
sample. The single-set case is defined by the absence of any
<code>runCol</code> input (see next section). We here provide a
(non-exhaustive) list of typical data sets that fall under the
single-set case:</p><ul><li><p>Peptide- or protein-level label-free data (bulk or single-cell).</p></li>
<li><p>Peptide- or protein-level multiplexed (e.g. TMT) data (bulk or
single-cell).</p></li>
<li><p>PSM-level multiplexed data acquired in a single MS run (bulk or
single-cell).</p></li>
<li><p>PSM-level data from fractionation experiments, where each
fraction of the same sample was acquired with the same
multiplexing label.</p></li>
</ul></div>

<div class="section">
<h3 id="multi-set-case">Multi-set case<a class="anchor" aria-label="anchor" href="#multi-set-case"></a></h3>


<p>A run/batch variable, <code>runCol</code>, is required to import multi-set
data. The multi-set case can be represented schematically as shown
below.</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="sc">|--------+------+----------------+-----------</span><span class="er">|</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="er">|</span> runCol <span class="sc">|</span> cols <span class="sc">|</span> quantCols <span class="dv">1</span>..N <span class="sc">|</span> more cols <span class="sc">|</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="er">|</span>   <span class="dv">1</span>    <span class="sc">|</span> .    <span class="sc">|</span> ...            <span class="sc">|</span> ...       <span class="sc">|</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="er">|</span>   <span class="dv">1</span>    <span class="sc">|</span> .    <span class="sc">|</span> ...            <span class="sc">|</span> ...       <span class="sc">|</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="er">|</span><span class="sc">--------+------+----------------+-----------</span><span class="er">|</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="er">|</span>   <span class="dv">2</span>    <span class="sc">|</span> .    <span class="sc">|</span> ...            <span class="sc">|</span> ...       <span class="sc">|</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="er">|</span><span class="sc">--------+------+----------------+-----------</span><span class="er">|</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="er">|</span>   .    <span class="sc">|</span> .    <span class="sc">|</span> ...            <span class="sc">|</span> ...       <span class="sc">|</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="er">|</span><span class="sc">--------+------+----------------+-----------</span><span class="er">|</span></span></code></pre><p></p></div>
<p>Every <code>quantCols</code> column contains data for multiple samples
acquired in different runs. The multi-set case applies when
<code>runCol</code> is provided, which will determine how the table is split
into multiple sets.</p>
<p>We here provide a (non-exhaustive) list of typical data sets that
fall under the multi-set case:</p><ul><li><p>PSM- or precursor-level multiplexed data acquired in multiple
runs (bulk or single-cell)</p></li>
<li><p>PSM- or precursor-level label-free data acquired in multiple
runs (bulk or single-cell)</p></li>
<li><p>DIA-NN data (see also <code><a href="readQFeaturesFromDIANN.html">readQFeaturesFromDIANN()</a></code>).</p></li>
</ul></div>

<div class="section">
<h3 id="adding-sample-annotations-with-coldata">Adding sample annotations with <code>colData</code><a class="anchor" aria-label="anchor" href="#adding-sample-annotations-with-coldata"></a></h3>


<p>We recommend providing sample annotations when creating a
<code>QFeatures</code> object. The <code>colData</code> is a table in which each row
corresponds to a sample and each column provides information about
the samples. There is no restriction on the number of columns and
on the type of data they should contain. However, we impose one or
two columns (depending on the use case) that allow to link the
annotations of each sample to its quantitative data:</p><ul><li><p>Single-set case: the <code>colData</code> must contain a column named
<code>quantCols</code> that provides the names of the columns in
<code>assayData</code> containing quantitative values for each sample (see
single-set cases in the examples).</p></li>
<li><p>Multi-set case: the <code>colData</code> must contain a column named
<code>quantCols</code> that provides the names of the columns in
<code>assayData</code> with the quantitative values for each sample, and a
column named <code>runCol</code> that provides the MS runs/batches in which
each sample has been acquired. The entries in
<code>colData[["runCol"]]</code> are matched against the entries provided
by <code>assayData[[runCol]]</code>.</p></li>
</ul><p>When the <code>quantCols</code> argument is not provided to
<code>readQFeatures()</code>, the function will automatically determine the
<code>quantCols</code> from <code>colData[["quantCols"]]</code>. Therefore, <code>quantCols</code>
and <code>colData</code> cannot be both missing.</p>
<p>Samples that are present in <code>assayData</code> but absent
<code>colData</code> will lead to a warning, and the missing entries will be
automatically added to the <code>colData</code> and filled with <code>NA</code>s.</p>
<p>When using the <code>quantCols</code> and <code>runCol</code> arguments only
(without <code>colData</code>), the <code>colData</code> contains zero
columns/variables.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p>The <code>QFeatures</code> (see <code><a href="QFeatures-class.html">QFeatures()</a></code>) class to read about how to
manipulate the resulting <code>QFeatures</code> object.</p></li>
<li><p>The <code><a href="readQFeaturesFromDIANN.html">readQFeaturesFromDIANN()</a></code> function to import DIA-NN
quantitative data.</p></li>
</ul></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Laurent Gatto, Christophe Vanderaa</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">######################################</span></span></span>
<span class="r-in"><span><span class="co">## Single-set case.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Load a data.frame with PSM-level data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">hlpsms</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hlpsms</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">10</span><span class="op">:</span><span class="fl">11</span>, <span class="fl">14</span>, <span class="fl">17</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           X126      X127C       X131 Sequence ProteinGroupAccessions     PEP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 383 0.12283431 0.08045915 0.11961594  SQGEIDk                 Q8BYY4 0.11800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 475 0.35268185 0.14162381 0.02957384  YEAQGDk                 P46467 0.01070</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 478 0.01546089 0.16142297 0.04370403  TTScDTk                 Q64449 0.11800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 552 0.04702854 0.09288723 0.10014038  aEELESR                 P60469 0.04450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596 0.01044693 0.15866147 0.02307803  aQEEAIk               P13597-2 0.00850</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 610 0.04955362 0.01215244 0.29732174 dGAVDGcR                 Q6P5D8 0.00322</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 731 0.04007112 0.06632932 0.10188731 AcDSAEVk                 Q01237 0.04090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 786 0.16122744 0.10251588 0.04884985 VSSDEDLk                 Q9D8U8 0.00130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 795 0.60288497 0.11022069 0.02182222  TDQNYEk                 Q8BMJ2 0.01880</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 816 0.10298287 0.05818306 0.07723716  QEEIQQk                 Q3URD3 0.02900</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create a QFeatures object with a single psms set</span></span></span>
<span class="r-in"><span><span class="va">qf1</span> <span class="op">&lt;-</span> <span class="fu">readQFeatures</span><span class="op">(</span><span class="va">hlpsms</span>, quantCols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, name <span class="op">=</span> <span class="st">"psms"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking arguments.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading data as a 'SummarizedExperiment' object.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Formatting sample annotations (colData).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Formatting data as a 'QFeatures' object.</span>
<span class="r-in"><span><span class="va">qf1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class QFeatures (type: bulk) with 1 set:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] psms: SummarizedExperiment with 3010 rows and 10 columns </span>
<span class="r-in"><span><span class="fu">colData</span><span class="op">(</span><span class="va">qf1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 10 rows and 0 columns</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">######################################</span></span></span>
<span class="r-in"><span><span class="co">## Single-set case with colData.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">coldat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      quantCols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">hlpsms</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           var quantCols</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0.1179067      X126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  -0.3912262     X127C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   0.8497468     X127N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   0.6412677     X128C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  -0.8533205     X128N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   1.4502467     X129C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  -0.5834776     X129N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  -1.5154718     X130C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   1.4507215     X130N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 -0.8785367      X131</span>
<span class="r-in"><span><span class="va">qf2</span> <span class="op">&lt;-</span> <span class="fu">readQFeatures</span><span class="op">(</span><span class="va">hlpsms</span>, colData <span class="op">=</span> <span class="va">coldat</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking arguments.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading data as a 'SummarizedExperiment' object.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Formatting sample annotations (colData).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Formatting data as a 'QFeatures' object.</span>
<span class="r-in"><span><span class="va">qf2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class QFeatures (type: bulk) with 1 set:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] quants: SummarizedExperiment with 3010 rows and 10 columns </span>
<span class="r-in"><span><span class="fu">colData</span><span class="op">(</span><span class="va">qf2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 10 rows and 2 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             var   quantCols</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;numeric&gt; &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X126   0.117907        X126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X127C -0.391226       X127C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X127N  0.849747       X127N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X128C  0.641268       X128C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X128N -0.853321       X128N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X129C  1.450247       X129C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X129N -0.583478       X129N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X130C -1.515472       X130C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X130N  1.450721       X130N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X131  -0.878537        X131</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">######################################</span></span></span>
<span class="r-in"><span><span class="co">## Multi-set case.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Let's simulate 3 different files/batches for that same input</span></span></span>
<span class="r-in"><span><span class="co">## data.frame, and define a colData data.frame.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">hlpsms</span><span class="op">$</span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"File"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">hlpsms</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hlpsms</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">10</span><span class="op">:</span><span class="fl">11</span>, <span class="fl">14</span>, <span class="fl">17</span>, <span class="fl">29</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           X126      X127C       X131 Sequence ProteinGroupAccessions     PEP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 383 0.12283431 0.08045915 0.11961594  SQGEIDk                 Q8BYY4 0.11800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 475 0.35268185 0.14162381 0.02957384  YEAQGDk                 P46467 0.01070</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 478 0.01546089 0.16142297 0.04370403  TTScDTk                 Q64449 0.11800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 552 0.04702854 0.09288723 0.10014038  aEELESR                 P60469 0.04450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596 0.01044693 0.15866147 0.02307803  aQEEAIk               P13597-2 0.00850</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 610 0.04955362 0.01215244 0.29732174 dGAVDGcR                 Q6P5D8 0.00322</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 731 0.04007112 0.06632932 0.10188731 AcDSAEVk                 Q01237 0.04090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 786 0.16122744 0.10251588 0.04884985 VSSDEDLk                 Q9D8U8 0.00130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 795 0.60288497 0.11022069 0.02182222  TDQNYEk                 Q8BMJ2 0.01880</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 816 0.10298287 0.05818306 0.07723716  QEEIQQk                 Q3URD3 0.02900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      file</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 383 File3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 475 File3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 478 File2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 552 File2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596 File1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 610 File2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 731 File1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 786 File2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 795 File2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 816 File2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">qf3</span> <span class="op">&lt;-</span> <span class="fu">readQFeatures</span><span class="op">(</span><span class="va">hlpsms</span>, quantCols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, runCol <span class="op">=</span> <span class="st">"file"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking arguments.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading data as a 'SummarizedExperiment' object.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Splitting data in runs.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Formatting sample annotations (colData).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Formatting data as a 'QFeatures' object.</span>
<span class="r-in"><span><span class="va">qf3</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class QFeatures (type: bulk) with 3 sets:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] File1: SummarizedExperiment with 987 rows and 10 columns </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2] File2: SummarizedExperiment with 999 rows and 10 columns </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3] File3: SummarizedExperiment with 1024 rows and 10 columns </span>
<span class="r-in"><span><span class="fu">colData</span><span class="op">(</span><span class="va">qf3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 30 rows and 0 columns</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">######################################</span></span></span>
<span class="r-in"><span><span class="co">## Multi-set case with colData.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">coldat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>runCol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"File"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      quantCols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">hlpsms</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    runCol        var quantCols</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   File1  1.4355254      X126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   File1  1.1164447     X127C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   File1  0.3708669     X127N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   File1 -0.2440149     X128C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   File1 -0.3593569     X128N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   File1 -1.4886982     X129C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   File1  0.1080776     X129N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   File1 -1.1260707     X130C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   File1  0.7647629     X130N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  File1  0.4455515      X131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  File2  1.4355254      X126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  File2  1.1164447     X127C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  File2  0.3708669     X127N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  File2 -0.2440149     X128C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  File2 -0.3593569     X128N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  File2 -1.4886982     X129C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  File2  0.1080776     X129N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  File2 -1.1260707     X130C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  File2  0.7647629     X130N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  File2  0.4455515      X131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  File3  1.4355254      X126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  File3  1.1164447     X127C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  File3  0.3708669     X127N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  File3 -0.2440149     X128C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  File3 -0.3593569     X128N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  File3 -1.4886982     X129C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  File3  0.1080776     X129N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  File3 -1.1260707     X130C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29  File3  0.7647629     X130N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30  File3  0.4455515      X131</span>
<span class="r-in"><span><span class="va">qf4</span> <span class="op">&lt;-</span> <span class="fu">readQFeatures</span><span class="op">(</span><span class="va">hlpsms</span>, colData <span class="op">=</span> <span class="va">coldat</span>, runCol <span class="op">=</span> <span class="st">"file"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking arguments.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading data as a 'SummarizedExperiment' object.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Splitting data in runs.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Formatting sample annotations (colData).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Formatting data as a 'QFeatures' object.</span>
<span class="r-in"><span><span class="va">qf4</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class QFeatures (type: bulk) with 3 sets:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] File1: SummarizedExperiment with 987 rows and 10 columns </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2] File2: SummarizedExperiment with 999 rows and 10 columns </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3] File3: SummarizedExperiment with 1024 rows and 10 columns </span>
<span class="r-in"><span><span class="fu">colData</span><span class="op">(</span><span class="va">qf4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 30 rows and 3 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  runCol       var   quantCols</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             &lt;character&gt; &lt;numeric&gt; &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> File1_X126        File1  1.435525        X126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> File1_X127C       File1  1.116445       X127C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> File1_X127N       File1  0.370867       X127N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> File1_X128C       File1 -0.244015       X128C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> File1_X128N       File1 -0.359357       X128N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...                 ...       ...         ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> File3_X129C       File3 -1.488698       X129C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> File3_X129N       File3  0.108078       X129N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> File3_X130C       File3 -1.126071       X130C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> File3_X130N       File3  0.764763       X130N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> File3_X131        File3  0.445552        X131</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Laurent Gatto, Christophe Vanderaa.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer></div>





  </body></html>

