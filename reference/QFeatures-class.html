<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Quantitative MS QFeatures — QFeatures • QFeatures</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quantitative MS QFeatures — QFeatures"><meta name="description" content="Conceptually, a QFeatures object holds a set of assays, each
composed of a matrix (or array) containing quantitative data
and row annotations (meta-data).  The number and the names of the
columns (samples) must always be the same across the assays, but
the number and the names of the rows (features) can vary. The
assays are typically defined as SummarizedExperiment objects. In
addition, a QFeatures object also uses a single DataFrame to
annotate the samples (columns) represented in all the matrices.
The QFeatures class extends the
MultiAssayExperiment::MultiAssayExperiment and inherits all
the functionality of the
MultiAssayExperiment::MultiAssayExperiment class.
A typical use case for such QFeatures object is to represent
quantitative proteomics (or metabolomics) data, where different
assays represent quantitation data at the PSM (the main assay),
peptide and protein level, and where peptide values are computed
from the PSM data, and the protein-level data is calculated based
on the peptide-level values. The largest assay (the one with the
highest number of features, PSMs in the example above) is
considered the main assay.
The recommended way to create QFeatures objects is the use the
readQFeatures() function, that creates an instance from tabular
data. The QFeatures constructor can be used to create objects
from their bare parts.  It is the user's responsability to make
sure that these match the class validity requirements."><meta property="og:description" content="Conceptually, a QFeatures object holds a set of assays, each
composed of a matrix (or array) containing quantitative data
and row annotations (meta-data).  The number and the names of the
columns (samples) must always be the same across the assays, but
the number and the names of the rows (features) can vary. The
assays are typically defined as SummarizedExperiment objects. In
addition, a QFeatures object also uses a single DataFrame to
annotate the samples (columns) represented in all the matrices.
The QFeatures class extends the
MultiAssayExperiment::MultiAssayExperiment and inherits all
the functionality of the
MultiAssayExperiment::MultiAssayExperiment class.
A typical use case for such QFeatures object is to represent
quantitative proteomics (or metabolomics) data, where different
assays represent quantitation data at the PSM (the main assay),
peptide and protein level, and where peptide values are computed
from the PSM data, and the protein-level data is calculated based
on the peptide-level values. The largest assay (the one with the
highest number of features, PSMs in the example above) is
considered the main assay.
The recommended way to create QFeatures objects is the use the
readQFeatures() function, that creates an instance from tabular
data. The QFeatures constructor can be used to create objects
from their bare parts.  It is the user's responsability to make
sure that these match the class validity requirements."><meta property="og:image" content="https://rformassspectrometry.github.io/QFeatures/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">QFeatures</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.19.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/QFeatures.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Processing.html">Processing quantitative proteomics data with QFeatures</a></li>
    <li><a class="dropdown-item" href="../articles/read_QFeatures.html">Load mass spectrometry-based proteomics data using `readQFeatures()`</a></li>
    <li><a class="dropdown-item" href="../articles/Visualization.html">Data visualization from a QFeatures object</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RforMassSpectrometry/QFeatures/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Quantitative MS QFeatures</h1>
      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/QFeatures/blob/master/R/QFeatures-class.R" class="external-link"><code>R/QFeatures-class.R</code></a></small>
      <div class="d-none name"><code>QFeatures-class.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Conceptually, a <code>QFeatures</code> object holds a set of <em>assays</em>, each
composed of a <code>matrix</code> (or <code>array</code>) containing quantitative data
and row annotations (meta-data).  The number and the names of the
columns (samples) must always be the same across the assays, but
the number and the names of the rows (features) can vary. The
assays are typically defined as <code>SummarizedExperiment</code> objects. In
addition, a <code>QFeatures</code> object also uses a single <code>DataFrame</code> to
annotate the samples (columns) represented in all the matrices.</p>
<p>The <code>QFeatures</code> class extends the
<a href="https://github.com/waldronlab/MultiAssayExperiment/reference/MultiAssayExperiment.html" class="external-link">MultiAssayExperiment::MultiAssayExperiment</a> and inherits all
the functionality of the
<a href="https://github.com/waldronlab/MultiAssayExperiment/reference/MultiAssayExperiment.html" class="external-link">MultiAssayExperiment::MultiAssayExperiment</a> class.</p>
<p>A typical use case for such <code>QFeatures</code> object is to represent
quantitative proteomics (or metabolomics) data, where different
assays represent quantitation data at the PSM (the main assay),
peptide and protein level, and where peptide values are computed
from the PSM data, and the protein-level data is calculated based
on the peptide-level values. The largest assay (the one with the
highest number of features, PSMs in the example above) is
considered the main assay.</p>
<p>The recommended way to create <code>QFeatures</code> objects is the use the
<code><a href="readQFeatures.html">readQFeatures()</a></code> function, that creates an instance from tabular
data. The <code>QFeatures</code> constructor can be used to create objects
from their bare parts.  It is the user's responsability to make
sure that these match the class validity requirements.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">QFeatures</span><span class="op">(</span><span class="va">...</span>, assayLinks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'QFeatures'</span></span>
<span><span class="fu">show</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'QFeatures'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, interactive <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'QFeatures,ANY,ANY,ANY'</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span>, <span class="va">...</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># S4 method for class 'QFeatures,character,ANY,ANY'</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span>, <span class="va">k</span>, <span class="va">...</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># S4 method for class 'QFeatures'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'QFeatures'</span></span>
<span><span class="fu">dims</span><span class="op">(</span><span class="va">x</span>, use.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'QFeatures'</span></span>
<span><span class="fu">nrows</span><span class="op">(</span><span class="va">x</span>, use.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'QFeatures'</span></span>
<span><span class="fu">ncols</span><span class="op">(</span><span class="va">x</span>, use.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'QFeatures'</span></span>
<span><span class="fu">rowData</span><span class="op">(</span><span class="va">x</span>, use.names <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'QFeatures,DataFrameList'</span></span>
<span><span class="fu">rowData</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for class 'QFeatures,ANY'</span></span>
<span><span class="fu">rowData</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="fu">rbindRowData</span><span class="op">(</span><span class="va">object</span>, <span class="va">i</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">selectRowData</span><span class="op">(</span><span class="va">x</span>, <span class="va">rowvars</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">rowDataNames</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'QFeatures,character'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="fu">addAssay</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">name</span>, <span class="va">assayLinks</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">removeAssay</span><span class="op">(</span><span class="va">x</span>, <span class="va">i</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">replaceAssay</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">i</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'QFeatures,ANY,ANY'</span></span>
<span><span class="va">x</span><span class="op">[[</span><span class="va">i</span>, <span class="va">j</span>, <span class="va">...</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for class 'QFeatures'</span></span>
<span><span class="fu">updateObject</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">dropEmptyAssays</span><span class="op">(</span><span class="va">object</span>, dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>See <code>MultiAssayExperiment</code> for details. For <code>plot</code>,
further arguments passed to <code><a href="https://r.igraph.org/reference/plot.igraph.html" class="external-link">igraph::plot.igraph</a></code>.</p></dd>


<dt id="arg-assaylinks">assayLinks<a class="anchor" aria-label="anchor" href="#arg-assaylinks"></a></dt>
<dd><p>An optional <a href="AssayLinks.html">AssayLinks</a>.</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An instance of class QFeatures.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An instance of class QFeatures.</p></dd>


<dt id="arg-interactive">interactive<a class="anchor" aria-label="anchor" href="#arg-interactive"></a></dt>
<dd><p>A <code>logical(1)</code>. If <code>TRUE</code>, an interactive graph
is generated using <code>plotly</code>. Else, a static plot using <code>igraph</code>
is generated. We recommend interactive exploration when the
<code>QFeatures</code> object contains more than 50 assays.</p></dd>


<dt id="arg-i">i<a class="anchor" aria-label="anchor" href="#arg-i"></a></dt>
<dd><p>An indexing vector. See the corresponding section in the
documentation for more details.</p></dd>


<dt id="arg-j">j<a class="anchor" aria-label="anchor" href="#arg-j"></a></dt>
<dd><p><code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>, <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code>, or <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code> vector for
subsetting by <code>colData</code> rows.</p></dd>


<dt id="arg-drop">drop<a class="anchor" aria-label="anchor" href="#arg-drop"></a></dt>
<dd><p>logical (default <code>TRUE</code>) whether to drop empty assay
elements in the <code>ExperimentList</code>.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p><code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>, <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code>, or <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code> vector for
subsetting by assays</p></dd>


<dt id="arg-use-names">use.names<a class="anchor" aria-label="anchor" href="#arg-use-names"></a></dt>
<dd><p>A <code>logical(1)</code> indicating whether the rownames of
each assay should be propagated to the corresponding <code>rowData</code>.</p></dd>


<dt id="arg-value">value<a class="anchor" aria-label="anchor" href="#arg-value"></a></dt>
<dd><p>The values to use as a replacement. See the
corresponding section in the documentation for more details.</p></dd>


<dt id="arg-rowvars">rowvars<a class="anchor" aria-label="anchor" href="#arg-rowvars"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> with the names of the <code>rowData</code>
variables (columns) to retain in any assay.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>An object that inherits from <code>SummarizedExperiment</code> or a
<em>named</em> list of assays. When <code>y</code> is a list, each element must
inherit from a <code>SummarizedExperiment</code> and the names of the
list are used as the names of the assays to add. Hence, the
list names must be unique and cannot overlap with the names of
the assays already present in <code>x</code>.</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>A <code>character(1)</code> naming the single assay. Ignored if
<code>y</code> is a list of assays.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical (default FALSE) whether to print extra messages</p></dd>


<dt id="arg-dims">dims<a class="anchor" aria-label="anchor" href="#arg-dims"></a></dt>
<dd><p><code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code> that defines the dimensions to consider to
drop empty assays. 1 for rows (i.e. assays without any
features) and 2 for columns (i.e. assays without any
samples). Default is <code>1:2</code>. Any value other that 1 and/or 2
will trigger an error.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="constructors">Constructors<a class="anchor" aria-label="anchor" href="#constructors"></a></h2>


<ul><li><p><code>QFeatures(..., assayLinks)</code> allows the manual construction of
objects. It is the user's responsability to make sure these
comply. The arguments in <code>...</code> are those documented in
<code><a href="https://github.com/waldronlab/MultiAssayExperiment/reference/MultiAssayExperiment.html" class="external-link">MultiAssayExperiment::MultiAssayExperiment()</a></code>. For details
about <code>assayLinks</code>, see <a href="AssayLinks.html">AssayLinks</a>. An example is shown below.</p></li>
<li><p>The <code><a href="readQFeatures.html">readQFeatures()</a></code> function constructs a <code>QFeatures</code> object
from text-based spreadsheet or a <code>data.frame</code> used to generate
an assay. See the function manual page for details and an
example.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="accessors">Accessors<a class="anchor" aria-label="anchor" href="#accessors"></a></h2>


<ul><li><p>The <code>QFeatures</code> class extends the
<a href="https://github.com/waldronlab/MultiAssayExperiment/reference/MultiAssayExperiment.html" class="external-link">MultiAssayExperiment::MultiAssayExperiment</a> class and inherits
all its accessors and replacement methods.</p></li>
<li><p>The <code>rowData</code> method returns a <code>DataFrameList</code> containing the
<code>rowData</code> for each assay of the <code>QFeatures</code> object. On the other
hand, <code>rowData</code> can be modified using <code>rowData(x) &lt;- value</code>,
where <code>value</code> is a list of tables that can be coerced to <code>DFrame</code>
tables. The names of <code>value</code> point to the assays for
which the <code>rowData</code> must be replaced. The column names of each
table are used to replace the data in the existing <code>rowData</code>. If
the column name does not exist, a new column is added to the
<code>rowData</code>.</p></li>
<li><p>The <code>rbindRowData</code> functions returns a <code>DFrame</code> table that
contains the row binded <code>rowData</code> tables from the selected
assays. In this context, <code>i</code> is a <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>, <code><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer()</a></code> or
<code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code> object for subsetting assays. Only rowData variables
that are common to all assays are kept.</p></li>
<li><p>The <code>rowDataNames</code> accessor returns a list with the <code>rowData</code>
variable names.</p></li>
<li><p>The <code><a href="QFeatures-longForm.html">longForm()</a></code> accessor takes a <code>QFeatures</code> instance and returns it in a
long <em>tidy</em> <code>DataFrame</code>, where each quantitative value is reported on a
separate line.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="adding-removing-and-replacing-assays">Adding, removing and replacing assays<a class="anchor" aria-label="anchor" href="#adding-removing-and-replacing-assays"></a></h2>


<ul><li><p>The <code><a href="QFeatures-aggregate.html">aggregateFeatures()</a></code> function creates a new assay by
aggregating features of an existing assay.</p></li>
<li><p><code>addAssay(x, y, name, assayLinks)</code>: Adds one or more
new assay(s) <code>y</code> to the <code>QFeatures</code> instance <code>x</code>. <code>name</code>
is a <code>character(1)</code> naming the assay if only one assay is
provided, and is ignored if <code>y</code> is a list of assays. <code>assayLinks</code>
is an optional <a href="AssayLinks.html">AssayLinks</a>. The <code>colData(y)</code> is
automatically added to <code>colData(x)</code> by matching sample
names, that is <code>colnames(y)</code>. If the samples are not present in
<code>x</code>, the rows of <code>colData(x)</code> are extended to account for the
new samples. Be aware that conflicting information between the
<code>colData(y)</code> and the <code>colData(x)</code> will result in an
error.</p></li>
<li><p><code>removeAssay(x, i)</code>: Removes one or more assay(s) from the
<code>QFeatures</code> instance <code>x</code>. In this context, <code>i</code> is a <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>,
<code><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer()</a></code> or <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code> that indicates which assay(s) to
remove.</p></li>
<li><p><code>replaceAssay(x, y, i)</code>: Replaces one or more
assay(s) from the <code>QFeatures</code> instance <code>x</code>. In this context, <code>i</code>
is a <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>, <code><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer()</a></code> or <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code> that indicates
which assay(s) to replace. The <code>AssayLinks</code> from or to
any replaced assays are automatically removed, unless the
replacement has the same dimension names (columns and row, order
agnostic). Be aware that conflicting information between
<code>colData(y)</code> and <code>colData(x)</code> will result in an error.</p></li>
<li><p><code>x[[i]] &lt;- value</code>: a generic method for adding (when <code>i</code> is not
in <code>names(x)</code>), removing (when <code>value</code> is null) or replacing (when
<code>i</code> is in <code>names(x)</code>). Note that the arguments <code>j</code> and <code>...</code> from
the S4 replacement method signature are not allowed.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="subsetting">Subsetting<a class="anchor" aria-label="anchor" href="#subsetting"></a></h2>


<ul><li><p>QFeatures object can be subset using the <code>x[i, j, k, drop = TRUE]</code>
paradigm. In this context, <code>i</code> is a <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>, <code><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer()</a></code>,
<code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code> or <code>GRanges()</code> object for subsetting by rows. See
the argument descriptions for details on the remaining arguments.</p></li>
<li><p>The <code><a href="QFeatures-subsetBy.html">subsetByFeature()</a></code> function can be used to subset a
<code>QFeatures</code> object using one or multiple feature names that will
be matched across different assays, taking the aggregation
relation between assays.</p></li>
<li><p>The <code>selectRowData(x, rowvars)</code> function can be used to
select a limited number of <code>rowData</code> columns of interest named
in <code>rowvars</code> in the <code>x</code> instance of class <code>QFeatures</code>. All other
variables than <code>rowvars</code> will be dropped. In case an element in
<code>rowvars</code> isn't found in any <code>rowData</code> variable, a message is
printed.</p></li>
<li><p>The <code>dropEmptyAssays(object, dims)</code> function removes empty
assays from a <code>QFeatures</code>. Empty assays are defined as having 0
rows and/or 0 columns, as defined by the <code>dims</code> argument.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p>The <code><a href="readQFeatures.html">readQFeatures()</a></code> constructor and the <code><a href="QFeatures-aggregate.html">aggregateFeatures()</a></code>
function. The <em>QFeatures</em> vignette provides an extended example.</p></li>
<li><p>The <a href="QFeatures-filtering.html">QFeatures-filtering</a> manual page demonstrates how to filter
features based on their rowData.</p></li>
<li><p>The <a href="QFeatures-missing-data.html">missing-data</a> manual page to manage missing values in
<code>QFeatures</code> objects.</p></li>
<li><p>The <a href="QFeatures-processing.html">QFeatures-processing</a> and <code><a href="QFeatures-aggregate.html">aggregateFeatures()</a></code> manual pages
and <em>Processing</em> vignette describe common quantitative data
processing methods using in quantitative proteomics.</p></li>
</ul></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Laurent Gatto</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## ------------------------</span></span></span>
<span class="r-in"><span><span class="co">## An empty QFeatures object</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">QFeatures</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An empty instance of class QFeatures (type: bulk)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## -----------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Creating a QFeatures object manually</span></span></span>
<span class="r-in"><span><span class="co">## -----------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## two assays (matrices) with matching column names</span></span></span>
<span class="r-in"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">40</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">16</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sample_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">sample_names</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## two corresponding feature metadata with appropriate row names</span></span></span>
<span class="r-in"><span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu">DataFrame</span><span class="op">(</span>Fa <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, Fb <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                 row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu">DataFrame</span><span class="op">(</span>row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">se1</span> <span class="op">&lt;-</span> <span class="fu">SummarizedExperiment</span><span class="op">(</span><span class="va">m1</span>, <span class="va">df1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class: SummarizedExperiment </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dim: 10 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> metadata(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assays(1): ''</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rownames(10): a b ... i j</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rowData names(2): Fa Fb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colnames(4): S1 S2 S3 S4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colData names(0):</span>
<span class="r-in"><span><span class="op">(</span><span class="va">se2</span> <span class="op">&lt;-</span> <span class="fu">SummarizedExperiment</span><span class="op">(</span><span class="va">m2</span>, <span class="va">df2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class: SummarizedExperiment </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dim: 4 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> metadata(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assays(1): ''</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rownames(4): a b c d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rowData names(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colnames(4): S1 S2 S3 S4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colData names(0):</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Sample annotation (colData)</span></span></span>
<span class="r-in"><span><span class="va">cd</span> <span class="op">&lt;-</span> <span class="fu">DataFrame</span><span class="op">(</span>Var1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                Var2 <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                row.names <span class="op">=</span> <span class="va">sample_names</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">el</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>assay1 <span class="op">=</span> <span class="va">se1</span>, assay2 <span class="op">=</span> <span class="va">se2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fts1</span> <span class="op">&lt;-</span> <span class="fu">QFeatures</span><span class="op">(</span><span class="va">el</span>, colData <span class="op">=</span> <span class="va">cd</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fts1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class QFeatures (type: bulk) with 2 sets:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] assay1: SummarizedExperiment with 10 rows and 4 columns </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2] assay2: SummarizedExperiment with 4 rows and 4 columns </span>
<span class="r-in"><span><span class="va">fts1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class: SummarizedExperiment </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dim: 10 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> metadata(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assays(1): ''</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rownames(10): a b ... i j</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rowData names(2): Fa Fb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colnames(4): S1 S2 S3 S4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colData names(0):</span>
<span class="r-in"><span><span class="va">fts1</span><span class="op">[[</span><span class="st">"assay1"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class: SummarizedExperiment </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dim: 10 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> metadata(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assays(1): ''</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rownames(10): a b ... i j</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rowData names(2): Fa Fb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colnames(4): S1 S2 S3 S4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colData names(0):</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Rename assay</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fts1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"se1"</span>, <span class="st">"se2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Add an assay</span></span></span>
<span class="r-in"><span><span class="va">fts1</span> <span class="op">&lt;-</span> <span class="fu">addAssay</span><span class="op">(</span><span class="va">fts1</span>, <span class="va">se1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="op">]</span>, name <span class="op">=</span> <span class="st">"se3"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Get the assays feature metadata</span></span></span>
<span class="r-in"><span><span class="fu">rowData</span><span class="op">(</span><span class="va">fts1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrameList of length 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names(3): se1 se2 se3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Keep only the Fa variable</span></span></span>
<span class="r-in"><span><span class="fu">selectRowData</span><span class="op">(</span><span class="va">fts1</span>, rowvars <span class="op">=</span> <span class="st">"Fa"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class QFeatures (type: bulk) with 3 sets:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] se1: SummarizedExperiment with 10 rows and 4 columns </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2] se2: SummarizedExperiment with 4 rows and 4 columns </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3] se3: SummarizedExperiment with 2 rows and 4 columns </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## -----------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## See ?readQFeatures to create a</span></span></span>
<span class="r-in"><span><span class="co">## QFeatures object from a data.frame</span></span></span>
<span class="r-in"><span><span class="co">## or spreadsheet.</span></span></span>
<span class="r-in"><span><span class="co">## -----------------------------------</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Laurent Gatto, Christophe Vanderaa.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer></div>





  </body></html>

