<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Aggregate an assay's quantitative features — aggregateFeatures • QFeatures</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Aggregate an assay's quantitative features — aggregateFeatures"><meta property="og:description" content="This function aggregates the quantitative features of an assay,
applying a summarisation function (fun) to sets of features as
defined by the fcol feature variable. The new assay's features
will be named based on the unique fcol values.
In addition to the results of the aggregation, the newly
aggregated SummarizedExperiment assay also contains a new
aggcounts assay containing the aggregation counts matrix,
i.e. the number of features that were aggregated, which can be
accessed with the aggcounts() accessor.
The rowData of the aggregated SummarizedExperiment assay
contains a .n variable that provides the number of features that
were aggregated. This .n value is always &amp;gt;= that the
sample-level aggcounts."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">QFeatures</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.5.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/QFeatures.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Processing.html">Processing quantitative proteomics data with QFeatures</a>
    </li>
    <li>
      <a href="../articles/Visualization.html">Data visualization from a QFeatures object</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/RforMassSpectrometry/QFeatures/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Aggregate an assay's quantitative features</h1>
    <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/QFeatures/blob/HEAD/R/QFeatures-aggregation.R" class="external-link"><code>R/QFeatures-aggregation.R</code></a>, <a href="https://github.com/RforMassSpectrometry/QFeatures/blob/HEAD/R/SummarizedExperiment-methods.R" class="external-link"><code>R/SummarizedExperiment-methods.R</code></a></small>
    <div class="hidden name"><code>QFeatures-aggregate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function aggregates the quantitative features of an assay,
applying a summarisation function (<code>fun</code>) to sets of features as
defined by the <code>fcol</code> feature variable. The new assay's features
will be named based on the unique <code>fcol</code> values.</p>
<p>In addition to the results of the aggregation, the newly
aggregated <code>SummarizedExperiment</code> assay also contains a new
<code>aggcounts</code> assay containing the aggregation counts matrix,
i.e. the number of features that were aggregated, which can be
accessed with the <code>aggcounts()</code> accessor.</p>
<p>The rowData of the aggregated <code>SummarizedExperiment</code> assay
contains a <code>.n</code> variable that provides the number of features that
were aggregated. This <code>.n</code> value is always &gt;= that the
sample-level <code>aggcounts</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="co"># S4 method for QFeatures</span>
<span class="fu">aggregateFeatures</span><span class="op">(</span>
  <span class="va">object</span>,
  <span class="va">i</span>,
  <span class="va">fcol</span>,
  name <span class="op">=</span> <span class="st">"newAssay"</span>,
  fun <span class="op">=</span> <span class="fu">MsCoreUtils</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MsCoreUtils/man/robustSummary.html" class="external-link">robustSummary</a></span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S4 method for SummarizedExperiment</span>
<span class="fu">aggregateFeatures</span><span class="op">(</span><span class="va">object</span>, <span class="va">fcol</span>, fun <span class="op">=</span> <span class="fu">MsCoreUtils</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MsCoreUtils/man/robustSummary.html" class="external-link">robustSummary</a></span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S4 method for SummarizedExperiment</span>
<span class="fu">aggcounts</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>An instance of class <a href="QFeatures-class.html">QFeatures</a> or SummarizedExperiment.</p></dd>
<dt>i</dt>
<dd><p>The index or name of the assay which features will be
aggregated the create the new assay.</p></dd>
<dt>fcol</dt>
<dd><p>A <code>character(1)</code> naming a rowdata variable (of assay
<code>i</code> in case of a <code>QFeatures</code>) defining how to aggregate the
features of the assay. This variable is either a <code>character</code>
of a (possibly sparse) matrix. See below for details.</p></dd>
<dt>name</dt>
<dd><p>A <code>character(1)</code> naming the new assay. Default is
<code>newAssay</code>. Note that the function will fail if there's
already an assay with <code>name</code>.</p></dd>
<dt>fun</dt>
<dd><p>A function used for quantitative feature
aggregation. See Details for examples.</p></dd>
<dt>...</dt>
<dd><p>Additional parameters passed the <code>fun</code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>QFeatures</code> object with an additional assay or a
<code>SummarizedExperiment</code> object (or subclass thereof).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Aggregation is performed by a function that takes a matrix as
input and returns a vector of length equal to <code>ncol(x)</code>. Examples
thereof are</p><ul><li><p><code><a href="https://rdrr.io/pkg/MsCoreUtils/man/medianPolish.html" class="external-link">MsCoreUtils::medianPolish()</a></code> to fits an additive model (two way
decomposition) using Tukey's median polish_ procedure using
<code><a href="https://rdrr.io/r/stats/medpolish.html" class="external-link">stats::medpolish()</a></code>;</p></li>
<li><p><code><a href="https://rdrr.io/pkg/MsCoreUtils/man/robustSummary.html" class="external-link">MsCoreUtils::robustSummary()</a></code> to calculate a robust aggregation
using <code><a href="https://rdrr.io/pkg/MASS/man/rlm.html" class="external-link">MASS::rlm()</a></code> (default);</p></li>
<li><p><code><a href="https://rdrr.io/r/base/colSums.html" class="external-link">base::colMeans()</a></code> to use the mean of each column;</p></li>
<li><p><code><a href="https://rdrr.io/pkg/matrixStats/man/rowMedians.html" class="external-link">matrixStats::colMedians()</a></code> to use the median of each column.</p></li>
<li><p><code><a href="https://rdrr.io/r/base/colSums.html" class="external-link">base::colSums()</a></code> to use the sum of each column;</p></li>
</ul></div>
    <div id="missing-quantitative-values">
    <h2>Missing quantitative values</h2>
    


<p>Missing quantitative values have different effect based on the
aggregation method employed:</p><ul><li><p>The aggregation functions should be able to deal with missing
values by either ignoring them, and propagating them. This is
often done with an <code>na.rm</code> argument, that can be passed with
<code>...</code>. For example, <code>rowSums</code>, <code>rowMeans</code>, <code>rowMedians</code>,
... will ignore <code>NA</code> values with <code>na.rm = TRUE</code>, as illustrated
below.</p></li>
<li><p>Missing values will result in an error when using <code>medpolish</code>,
unless <code>na.rm = TRUE</code> is used. Note that this option relies on
implicit assumptions and/or performes an implicit imputation:
when summing, the values are implicitly imputed by 0, assuming
that the <code>NA</code> represent a trully absent features; when
averaging, the assumption is that the <code>NA</code> represented a
genuinely missing value.</p></li>
<li><p>When using robust summarisation, individual missing values are
excluded prior to fitting the linear model by robust
regression. To remove all values in the feature containing the
missing values, use <code><a href="QFeatures-missing-data.html">filterNA()</a></code>.</p></li>
</ul><p>More generally, missing values often need dedicated handling such
as filtering (see <code><a href="QFeatures-missing-data.html">filterNA()</a></code>) or imputation (see <code><a href="impute.html">impute()</a></code>).</p>
    </div>
    <div id="missing-values-in-the-row-data">
    <h2>Missing values in the row data</h2>
    


<p>Missing values in the row data of an assay will also impact the
resulting (aggregated) assay row data, as illustrated in the
example below. Any feature variables (a column in the row data)
containing <code>NA</code> values will be dropped from the aggregated row
data. The reasons underlying this drop are detailed in the
<code><a href="reduceDataFrame.html">reduceDataFrame()</a></code> manual page: only invariant aggregated rows,
i.e. rows resulting from the aggregation from identical variables,
are preserved during aggregations.</p>
<p>The situation illustrated below should however only happen in rare
cases and should often be imputable using the value of the other
aggregation rows before aggregation to preserve the invariant
nature of that column. In cases where an <code>NA</code> is present in an
otherwise variant column, the column would be dropped anyway.</p>
    </div>
    <div id="using-an-adjacency-matrix">
    <h2>Using an adjacency matrix</h2>
    


<p>When considering non-unique peptides, i.e. peptides that map to
multiple proteins, it is necessary to encode this ambiguity
explicitly using a peptide-by-proteins adjacency matrix. This
matrix is typically stored in the rowdata, is conventionally named
<code>"adjacencyMatrix"</code> and can be retrieved with
<code>adjacencyMatrix()</code>. It can be created manually (as illustrated
below) or using <code>PSMatch::makeAdjacencyMatrix()</code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>The <em>QFeatures</em> vignette provides an extended example and
the <em>Processing</em> vignette, for a complete quantitative
proteomics data processing pipeline.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## ---------------------------------------</span></span>
<span class="r-in"><span class="co">## An example QFeatures with PSM-level data</span></span>
<span class="r-in"><span class="co">## ---------------------------------------</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">feat1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">feat1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class QFeatures containing 1 assays:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] psms: SummarizedExperiment with 10 rows and 2 columns </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Aggregate PSMs into peptides</span></span>
<span class="r-in"><span class="va">feat1</span> <span class="op">&lt;-</span> <span class="fu">aggregateFeatures</span><span class="op">(</span><span class="va">feat1</span>, <span class="st">"psms"</span>, <span class="st">"Sequence"</span>, name <span class="op">=</span> <span class="st">"peptides"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">feat1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class QFeatures containing 2 assays:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] psms: SummarizedExperiment with 10 rows and 2 columns </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2] peptides: SummarizedExperiment with 3 rows and 2 columns </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Aggregate peptides into proteins</span></span>
<span class="r-in"><span class="va">feat1</span> <span class="op">&lt;-</span> <span class="fu">aggregateFeatures</span><span class="op">(</span><span class="va">feat1</span>, <span class="st">"peptides"</span>, <span class="st">"Protein"</span>, name <span class="op">=</span> <span class="st">"proteins"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">feat1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class QFeatures containing 3 assays:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] psms: SummarizedExperiment with 10 rows and 2 columns </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2] peptides: SummarizedExperiment with 3 rows and 2 columns </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3] proteins: SummarizedExperiment with 2 rows and 2 columns </span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">assay</span><span class="op">(</span><span class="va">feat1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       S1 S2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM1   1 11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM2   2 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM3   3 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM4   4 14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM5   5 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM6   6 16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM7   7 17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM8   8 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM9   9 19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSM10 10 20</span>
<span class="r-in"><span class="fu">assay</span><span class="op">(</span><span class="va">feat1</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              S1   S2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ELGNDAYK    5.0 15.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IAEESNFPFIK 8.5 18.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SYGFNAAR    2.0 12.0</span>
<span class="r-in"><span class="fu">aggcounts</span><span class="op">(</span><span class="va">feat1</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             S1 S2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ELGNDAYK     3  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IAEESNFPFIK  4  4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SYGFNAAR     3  3</span>
<span class="r-in"><span class="fu">assay</span><span class="op">(</span><span class="va">feat1</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        S1   S2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ProtA 3.5 13.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ProtB 8.5 18.5</span>
<span class="r-in"><span class="fu">aggcounts</span><span class="op">(</span><span class="va">feat1</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       S1 S2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ProtA  2  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ProtB  1  1</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## --------------------------------------------</span></span>
<span class="r-in"><span class="co">## Aggregation with missing quantitative values</span></span>
<span class="r-in"><span class="co">## --------------------------------------------</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ft_na</span><span class="op">)</span></span>
<span class="r-in"><span class="va">ft_na</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class QFeatures containing 1 assays:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] na: SummarizedExperiment with 4 rows and 3 columns </span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">assay</span><span class="op">(</span><span class="va">ft_na</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    A  B  C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a NA  5  9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b  2  6 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c  3 NA 11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d NA  8 12</span>
<span class="r-in"><span class="fu">rowData</span><span class="op">(</span><span class="va">ft_na</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 4 rows and 2 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           X           Y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;integer&gt; &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a         1           A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b         2           B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c         1           A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d         2           B</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## By default, missing values are propagated</span></span>
<span class="r-in"><span class="va">ft2</span> <span class="op">&lt;-</span> <span class="fu">aggregateFeatures</span><span class="op">(</span><span class="va">ft_na</span>, <span class="fl">1</span>, fcol <span class="op">=</span> <span class="st">"X"</span>, fun <span class="op">=</span> <span class="va">colSums</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Your quantitative data contain missing values. Please read the relevant</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> section(s) in the aggregateFeatures manual page regarding the effects</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> of missing values on data aggregation.</span>
<span class="r-in"><span class="fu">assay</span><span class="op">(</span><span class="va">ft2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    A  B  C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 NA NA 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 NA 14 22</span>
<span class="r-in"><span class="fu">aggcounts</span><span class="op">(</span><span class="va">ft2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A B C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 1 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1 2 2</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## The rowData .n variable tallies number of initial rows that</span></span>
<span class="r-in"><span class="co">## were aggregated (irrespective of NAs) for all the samples.</span></span>
<span class="r-in"><span class="fu">rowData</span><span class="op">(</span><span class="va">ft2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 2 rows and 3 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           X           Y        .n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;integer&gt; &lt;character&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1           A         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         2           B         2</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Ignored when setting na.rm = TRUE</span></span>
<span class="r-in"><span class="va">ft3</span> <span class="op">&lt;-</span> <span class="fu">aggregateFeatures</span><span class="op">(</span><span class="va">ft_na</span>, <span class="fl">1</span>, fcol <span class="op">=</span> <span class="st">"X"</span>, fun <span class="op">=</span> <span class="va">colSums</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Your quantitative data contain missing values. Please read the relevant</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> section(s) in the aggregateFeatures manual page regarding the effects</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> of missing values on data aggregation.</span>
<span class="r-in"><span class="fu">assay</span><span class="op">(</span><span class="va">ft3</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A  B  C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 3  5 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2 14 22</span>
<span class="r-in"><span class="fu">aggcounts</span><span class="op">(</span><span class="va">ft3</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A B C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 1 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1 2 2</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## -----------------------------------------------</span></span>
<span class="r-in"><span class="co">## Aggregation with missing values in the row data</span></span>
<span class="r-in"><span class="co">## -----------------------------------------------</span></span>
<span class="r-in"><span class="co">## Row data results without any NAs, which includes the</span></span>
<span class="r-in"><span class="co">## Y variables</span></span>
<span class="r-in"><span class="fu">rowData</span><span class="op">(</span><span class="va">ft2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 2 rows and 3 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           X           Y        .n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;integer&gt; &lt;character&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1           A         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         2           B         2</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Missing value in the Y feature variable</span></span>
<span class="r-in"><span class="fu">rowData</span><span class="op">(</span><span class="va">ft_na</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"Y"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span class="r-in"><span class="fu">rowData</span><span class="op">(</span><span class="va">ft_na</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 4 rows and 2 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           X           Y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;integer&gt; &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a         1          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b         2           B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c         1           A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d         2           B</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">ft3</span> <span class="op">&lt;-</span> <span class="fu">aggregateFeatures</span><span class="op">(</span><span class="va">ft_na</span>, <span class="fl">1</span>, fcol <span class="op">=</span> <span class="st">"X"</span>, fun <span class="op">=</span> <span class="va">colSums</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Your quantitative and row data contain missing values. Please read the</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> relevant section(s) in the aggregateFeatures manual page regarding the</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> effects of missing values on data aggregation.</span>
<span class="r-in"><span class="co">## The Y feature variable has been dropped!</span></span>
<span class="r-in"><span class="fu">assay</span><span class="op">(</span><span class="va">ft3</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    A  B  C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 NA NA 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 NA 14 22</span>
<span class="r-in"><span class="fu">rowData</span><span class="op">(</span><span class="va">ft3</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 2 rows and 2 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           X        .n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;integer&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         2         2</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## --------------------------------------------</span></span>
<span class="r-in"><span class="co">## Using a peptide-by-proteins adjacency matrix</span></span>
<span class="r-in"><span class="co">## --------------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Let's use assay peptides from object feat1 and</span></span>
<span class="r-in"><span class="co">## define that peptide SYGFNAAR maps to proteins</span></span>
<span class="r-in"><span class="co">## Prot A and B</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">se</span> <span class="op">&lt;-</span> <span class="va">feat1</span><span class="op">[[</span><span class="st">"peptides"</span><span class="op">]</span><span class="op">]</span></span>
<span class="r-in"><span class="fu">rowData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">Protein</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ProtA;ProtB"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">rowData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 3 rows and 4 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Sequence       Protein      location        .n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               &lt;character&gt;   &lt;character&gt;   &lt;character&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ELGNDAYK         ELGNDAYK         ProtA Mitochondr...         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IAEESNFPFIK IAEESNFPFI...         ProtB       unknown         4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SYGFNAAR         SYGFNAAR ProtA;Prot... Mitochondr...         3</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Manual encoding of the adjacency matrix</span></span>
<span class="r-in"><span class="va">adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span class="r-in">              dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>,</span>
<span class="r-in">                              <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ProtA"</span>, <span class="st">"ProtB"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">adj</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">adj</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">adj</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span class="r-in"><span class="va">adj</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             ProtA ProtB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ELGNDAYK        1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IAEESNFPFIK     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SYGFNAAR        1     1</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">rowData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">adjacencyMatrix</span> <span class="op">&lt;-</span> <span class="va">adj</span></span>
<span class="r-in"><span class="fu">rowData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 3 rows and 5 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Sequence       Protein      location        .n adjacencyMatrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               &lt;character&gt;   &lt;character&gt;   &lt;character&gt; &lt;integer&gt;        &lt;matrix&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ELGNDAYK         ELGNDAYK         ProtA Mitochondr...         3             1:0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IAEESNFPFIK IAEESNFPFI...         ProtB       unknown         4             0:1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SYGFNAAR         SYGFNAAR ProtA;Prot... Mitochondr...         3             1:1</span>
<span class="r-in"><span class="fu">adjacencyMatrix</span><span class="op">(</span><span class="va">se</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             ProtA ProtB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ELGNDAYK        1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IAEESNFPFIK     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SYGFNAAR        1     1</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Laurent Gatto, Christophe Vanderaa.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

