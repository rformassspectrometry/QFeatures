<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quantitative features for mass spectrometry data • QFeatures</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Quantitative features for mass spectrometry data">
<meta property="og:description" content="QFeatures">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">QFeatures</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.5.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/QFeatures.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Processing.html">Processing quantitative proteomics data with QFeatures</a>
    </li>
    <li>
      <a href="../articles/Visualization.html">Data visualization from a QFeatures object</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/RforMassSpectrometry/QFeatures/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Quantitative features for mass spectrometry data</h1>
                        <h4 data-toc-skip class="author">Laurent Gatto</h4>
                        
      
      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/QFeatures/blob/HEAD/vignettes/QFeatures.Rmd" class="external-link"><code>vignettes/QFeatures.Rmd</code></a></small>
      <div class="hidden name"><code>QFeatures.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>This vignette describes the functionality implemented in the QFeatures package. QFeatures provides infrastructure to manage and process quantitative features for high-throughput mass spectrometry assays, including proteomics and metabolomics.</p>
    </div>
    
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  document.querySelector("h1").className = "title";
});
</script><script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if (links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script><div class="section level1">
<h1 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h1>
<p>The <code>QFeatures</code> package provides infrastructure (that is classes to store data and the methods to process and manipulate them) to manage and analyse quantitative features from mass spectrometry experiments. It is based on the <code>SummarizedExperiment</code> and <code>MultiAssayExperiment</code> classes. Assays in a QFeatures object have a hierarchical relation: proteins are composed of peptides, themselves produced by spectra, as depicted in figure @ref(fig:featuresplot). Throughout the aggregation and processing of these data, the relations between assays are tracked and recorded, thus allowing users to easily navigate across spectra, peptide and protein quantitative data.</p>
<div class="figure">
<img src="QFeatures_files/figure-html/featuresplot-1.png" alt="Conceptual representation of a `QFeatures` object and the aggregative relation between different assays." width="700"><p class="caption">
Conceptual representation of a <code>QFeatures</code> object and the aggregative relation between different assays.
</p>
</div>
<p>In the following sections, we are going to demonstrate how to create a single-assay <code>QFeatures</code> objects starting from a spreadsheet, how to compute the next assays (peptides and proteins), and how these can be manipulated and explored.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/RforMassSpectrometry/QFeatures" class="external-link">"QFeatures"</a></span><span class="op">)</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="creating-qfeatures-object">Creating <code>QFeatures</code> object<a class="anchor" aria-label="anchor" href="#creating-qfeatures-object"></a>
</h1>
<p>While <code>QFeatures</code> objects can be created manually (see <code><a href="../reference/QFeatures-class.html">?QFeatures</a></code> for details), most users will probably possess quantitative data in a spreadsheet or a dataframe. In such cases, the easiest is to use the <code>readQFeatures</code> function to extract the quantitative data and metadata columns. Below, we load the <code>hlpsms</code> dataframe that contains data for 28 PSMs from the TMT-10plex <em>hyper</em>LOPIT spatial proteomics experiment from <span class="citation">(Christoforou et al. 2016)</span>. The <code>ecol</code> argument specifies that columns 1 to 10 contain quantitation data, and that the assay should be named <code>psms</code> in the returned <code>QFeatures</code> object, to reflect the nature of the data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">hlpsms</span><span class="op">)</span>
<span class="va">hl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQFeatures.html">readQFeatures</a></span><span class="op">(</span><span class="va">hlpsms</span>, ecol <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, name <span class="op">=</span> <span class="st">"psms"</span><span class="op">)</span>
<span class="va">hl</span></code></pre></div>
<pre><code><span class="co">## An instance of class QFeatures containing 1 assays:</span>
<span class="co">##  [1] psms: SummarizedExperiment with 3010 rows and 10 columns</span></code></pre>
<p>Below, we see that we can extract an assay using its index or its name. The individual assays are stored as <em>SummarizedExperiment</em> object and further access its quantitative data and metadata using the <code>assay</code> and <code>rowData</code> functions</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hl</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">## class: SummarizedExperiment </span>
<span class="co">## dim: 3010 10 </span>
<span class="co">## metadata(0):</span>
<span class="co">## assays(1): ''</span>
<span class="co">## rownames(3010): 1 2 ... 3009 3010</span>
<span class="co">## rowData names(18): Sequence ProteinDescriptions ... RTmin markers</span>
<span class="co">## colnames(10): X126 X127C ... X130N X131</span>
<span class="co">## colData names(0):</span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hl</span><span class="op">[[</span><span class="st">"psms"</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">## class: SummarizedExperiment </span>
<span class="co">## dim: 3010 10 </span>
<span class="co">## metadata(0):</span>
<span class="co">## assays(1): ''</span>
<span class="co">## rownames(3010): 1 2 ... 3009 3010</span>
<span class="co">## rowData names(18): Sequence ProteinDescriptions ... RTmin markers</span>
<span class="co">## colnames(10): X126 X127C ... X130N X131</span>
<span class="co">## colData names(0):</span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">assay</span><span class="op">(</span><span class="va">hl</span><span class="op">[[</span><span class="st">"psms"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##         X126      X127C       X127N      X128C       X128N      X129C</span>
<span class="co">## 1 0.12283431 0.08045915 0.070804055 0.09386901 0.051815695 0.13034383</span>
<span class="co">## 2 0.35268185 0.14162381 0.167523880 0.07843497 0.071087436 0.03214548</span>
<span class="co">## 3 0.01546089 0.16142297 0.086938133 0.23120844 0.114664348 0.09610188</span>
<span class="co">## 4 0.04702854 0.09288723 0.102012167 0.11125409 0.067969116 0.14155358</span>
<span class="co">## 5 0.01044693 0.15866147 0.167315736 0.21017494 0.147946673 0.07088253</span>
<span class="co">## 6 0.04955362 0.01215244 0.002477681 0.01297833 0.002988949 0.06253195</span>
<span class="co">##        X129N       X130C      X130N       X131</span>
<span class="co">## 1 0.17540095 0.040068658 0.11478839 0.11961594</span>
<span class="co">## 2 0.06686260 0.031961793 0.02810434 0.02957384</span>
<span class="co">## 3 0.15977819 0.010127118 0.08059400 0.04370403</span>
<span class="co">## 4 0.18015910 0.035329902 0.12166589 0.10014038</span>
<span class="co">## 5 0.17555789 0.007088253 0.02884754 0.02307803</span>
<span class="co">## 6 0.01726511 0.172651119 0.37007905 0.29732174</span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">rowData</span><span class="op">(</span><span class="va">hl</span><span class="op">[[</span><span class="st">"psms"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## DataFrame with 6 rows and 18 columns</span>
<span class="co">##      Sequence ProteinDescriptions NbProteins ProteinGroupAccessions</span>
<span class="co">##   &lt;character&gt;         &lt;character&gt;  &lt;integer&gt;            &lt;character&gt;</span>
<span class="co">## 1     SQGEIDk       Tetratrico...          1                 Q8BYY4</span>
<span class="co">## 2     YEAQGDk       Vacuolar p...          1                 P46467</span>
<span class="co">## 3     TTScDTk       C-type man...          1                 Q64449</span>
<span class="co">## 4     aEELESR       Liprin-alp...          1                 P60469</span>
<span class="co">## 5     aQEEAIk       Isoform 2 ...          2               P13597-2</span>
<span class="co">## 6    dGAVDGcR       Structural...          1                 Q6P5D8</span>
<span class="co">##   Modifications    qValue       PEP  IonScore NbMissedCleavages</span>
<span class="co">##     &lt;character&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;integer&gt;         &lt;integer&gt;</span>
<span class="co">## 1 K7(TMT6ple...     0.008   0.11800        27                 0</span>
<span class="co">## 2 K7(TMT6ple...     0.001   0.01070        27                 0</span>
<span class="co">## 3 C4(Carbami...     0.008   0.11800        11                 0</span>
<span class="co">## 4 N-Term(TMT...     0.002   0.04450        24                 0</span>
<span class="co">## 5 N-Term(Car...     0.001   0.00850        36                 0</span>
<span class="co">## 6 N-Term(TMT...     0.000   0.00322        26                 0</span>
<span class="co">##   IsolationInterference IonInjectTimems Intensity    Charge      mzDa      MHDa</span>
<span class="co">##               &lt;integer&gt;       &lt;integer&gt; &lt;numeric&gt; &lt;integer&gt; &lt;numeric&gt; &lt;numeric&gt;</span>
<span class="co">## 1                     0              70    335000         2   503.274   1005.54</span>
<span class="co">## 2                     0              70    926000         2   520.267   1039.53</span>
<span class="co">## 3                     0              70    159000         2   521.258   1041.51</span>
<span class="co">## 4                     0              70    232000         2   531.785   1062.56</span>
<span class="co">## 5                     0              70    212000         2   537.804   1074.60</span>
<span class="co">## 6                     0              70    865000         2   539.761   1078.51</span>
<span class="co">##   DeltaMassPPM     RTmin       markers</span>
<span class="co">##      &lt;numeric&gt; &lt;numeric&gt;   &lt;character&gt;</span>
<span class="co">## 1        -0.38     24.02       unknown</span>
<span class="co">## 2         0.61     18.85       unknown</span>
<span class="co">## 3         1.11     10.17       unknown</span>
<span class="co">## 4         0.35     29.18       unknown</span>
<span class="co">## 5         1.70     25.56 Plasma mem...</span>
<span class="co">## 6        -0.67     21.27 Nucleus - ...</span></code></pre>
<p>For further details on how to manipulate such objects, refer to the <em><a href="https://bioconductor.org/packages/3.15/MultiAssayExperiment" class="external-link">MultiAssayExperiment</a></em> <span class="citation">(Ramos et al. 2017)</span> and <em><a href="https://bioconductor.org/packages/3.15/SummerizedExperiment" class="external-link">SummerizedExperiment</a></em> <span class="citation">(Morgan et al. 2019)</span> packages.</p>
<p>As illustrated in figure @ref(fig:featuresplot), an central characteristic of <code>QFeatures</code> objects is the aggregative relation between their assays. This can be obtained with the <code>aggregateFeatures</code> function that will aggregate quantitative features from one assay into a new one. In the next code chunk, we aggregate PSM-level data into peptide by grouping all PSMs that were matched the same peptide sequence. Below, the aggregation function is set, as an example, to the mean. The new assay is named <em>peptides</em>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/QFeatures-aggregate.html">aggregateFeatures</a></span><span class="op">(</span><span class="va">hl</span>, <span class="st">"psms"</span>, <span class="st">"Sequence"</span>, name <span class="op">=</span> <span class="st">"peptides"</span>, fun <span class="op">=</span> <span class="va">colMeans</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Your row data contain missing values. Please read the relevant</span>
<span class="co">## section(s) in the aggregateFeatures manual page regarding the effects</span>
<span class="co">## of missing values on data aggregation.</span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hl</span></code></pre></div>
<pre><code><span class="co">## An instance of class QFeatures containing 2 assays:</span>
<span class="co">##  [1] psms: SummarizedExperiment with 3010 rows and 10 columns </span>
<span class="co">##  [2] peptides: SummarizedExperiment with 2923 rows and 10 columns</span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hl</span><span class="op">[[</span><span class="st">"peptides"</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">## class: SummarizedExperiment </span>
<span class="co">## dim: 2923 10 </span>
<span class="co">## metadata(0):</span>
<span class="co">## assays(2): assay aggcounts</span>
<span class="co">## rownames(2923): aAADADVSLHNFSAR aAADPSEk ... yYSFFDLNPk YYSIASSSk</span>
<span class="co">## rowData names(7): Sequence ProteinDescriptions ... markers .n</span>
<span class="co">## colnames(10): X126 X127C ... X130N X131</span>
<span class="co">## colData names(0):</span></code></pre>
<p>Below, we repeat the aggregation operation by grouping peptides into proteins as defined by the <em>ProteinGroupAccessions</em> variable.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/QFeatures-aggregate.html">aggregateFeatures</a></span><span class="op">(</span><span class="va">hl</span>, <span class="st">"peptides"</span>, <span class="st">"ProteinGroupAccessions"</span>, name <span class="op">=</span> <span class="st">"proteins"</span>, fun <span class="op">=</span> <span class="va">colMeans</span><span class="op">)</span>
<span class="va">hl</span></code></pre></div>
<pre><code><span class="co">## An instance of class QFeatures containing 3 assays:</span>
<span class="co">##  [1] psms: SummarizedExperiment with 3010 rows and 10 columns </span>
<span class="co">##  [2] peptides: SummarizedExperiment with 2923 rows and 10 columns </span>
<span class="co">##  [3] proteins: SummarizedExperiment with 1596 rows and 10 columns</span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hl</span><span class="op">[[</span><span class="st">"proteins"</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">## class: SummarizedExperiment </span>
<span class="co">## dim: 1596 10 </span>
<span class="co">## metadata(0):</span>
<span class="co">## assays(2): assay aggcounts</span>
<span class="co">## rownames(1596): A2A432 A2A6Q5-3 ... Q9Z2Z9 Q9Z315</span>
<span class="co">## rowData names(3): ProteinGroupAccessions markers .n</span>
<span class="co">## colnames(10): X126 X127C ... X130N X131</span>
<span class="co">## colData names(0):</span></code></pre>
<p>The sample assayed in a <code>QFeatures</code> object can be documented in the <code>colData</code> slot. The <code>hl</code> data doens’t currently possess any sample metadata. These can be addedd as a new <code>DataFrame</code> with matching names (i.e. the <code>DataFrame</code> rownames must be identical assay’s colnames) or can be added one variable at at time, as shown below.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">colData</span><span class="op">(</span><span class="va">hl</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## DataFrame with 10 rows and 0 columns</span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hl</span><span class="op">$</span><span class="va">tag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"126"</span>, <span class="st">"127N"</span>, <span class="st">"127C"</span>, <span class="st">"128N"</span>, <span class="st">"128C"</span>, <span class="st">"129N"</span>, <span class="st">"129C"</span>,
            <span class="st">"130N"</span>, <span class="st">"130C"</span>, <span class="st">"131"</span><span class="op">)</span>
<span class="fu">colData</span><span class="op">(</span><span class="va">hl</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## DataFrame with 10 rows and 1 column</span>
<span class="co">##               tag</span>
<span class="co">##       &lt;character&gt;</span>
<span class="co">## X126          126</span>
<span class="co">## X127C        127N</span>
<span class="co">## X127N        127C</span>
<span class="co">## X128C        128N</span>
<span class="co">## X128N        128C</span>
<span class="co">## X129C        129N</span>
<span class="co">## X129N        129C</span>
<span class="co">## X130C        130N</span>
<span class="co">## X130N        130C</span>
<span class="co">## X131          131</span></code></pre>
</div>
<div class="section level1">
<h1 id="manipulating-feature-metadata">Manipulating feature metadata<a class="anchor" aria-label="anchor" href="#manipulating-feature-metadata"></a>
</h1>
<p>The <code>QFeatures</code> package provides some utility functions that streamline the accession and manipulation of the feature metadata.</p>
<p>The feature metadata, more generally referred to as <code>rowData</code> in the Bioconductor ecosystem, is specific to each assay in a <code>QFeatures</code> object. Therefore there are as many <code>rowData</code> tables as there are assays. <code>rowDataNames</code> provides a list where each element contains the name of the <code>rowData</code> columns available in the corresponding assay.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/QFeatures-class.html">rowDataNames</a></span><span class="op">(</span><span class="va">hl</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## CharacterList of length 3</span>
<span class="co">## [["psms"]] Sequence ProteinDescriptions NbProteins ... RTmin markers</span>
<span class="co">## [["peptides"]] Sequence ProteinDescriptions NbProteins ... markers .n</span>
<span class="co">## [["proteins"]] ProteinGroupAccessions markers .n</span></code></pre>
<p>We saw above how to get the <code>rowData</code> from an assay, but we can also extract the <code>rowData</code> for all assays by calling the function on the <code>QFeautures</code> object directly. Similarly to <code>rowDataNames</code>, a list is returned where each element contains the <code>rowData</code> available in the corresponding assay.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rowData</span><span class="op">(</span><span class="va">hl</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## DataFrameList of length 3</span>
<span class="co">## names(3): psms peptides proteins</span></code></pre>
<p>In some cases, we are interested in extracting the <code>rowData</code> as a single data table. This is easily performed using the <code>rbindRowData</code> function. The function will automatically select the columns that are common to all selected assays.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/QFeatures-class.html">rbindRowData</a></span><span class="op">(</span><span class="va">hl</span>, i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"peptides"</span>, <span class="st">"proteins"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## DataFrame with 4519 rows and 5 columns</span>
<span class="co">##            assay       rowname ProteinGroupAccessions       markers        .n</span>
<span class="co">##      &lt;character&gt;   &lt;character&gt;            &lt;character&gt;   &lt;character&gt; &lt;integer&gt;</span>
<span class="co">## 1       peptides aAADADVSLH...                 P0C7N9       unknown         1</span>
<span class="co">## 2       peptides      aAADPSEk                 Q6P9Q6       unknown         1</span>
<span class="co">## 3       peptides aAAQFLTSTW...                 Q9D7Z3 Nucleus - ...         1</span>
<span class="co">## 4       peptides aAASGAAGDk...                 A2AGT5       unknown         1</span>
<span class="co">## 5       peptides     AAAVSTEGk                 Q9ERE8       unknown         1</span>
<span class="co">## ...          ...           ...                    ...           ...       ...</span>
<span class="co">## 4515    proteins        Q9Z2V5                 Q9Z2V5       unknown         1</span>
<span class="co">## 4516    proteins        Q9Z2W0                 Q9Z2W0       unknown         1</span>
<span class="co">## 4517    proteins        Q9Z2X1                 Q9Z2X1       unknown         1</span>
<span class="co">## 4518    proteins        Q9Z2Z9                 Q9Z2Z9       unknown         3</span>
<span class="co">## 4519    proteins        Q9Z315                 Q9Z315       unknown         1</span></code></pre>
<p>We can also replace and add columns in the <code>rowData</code>. This requires to provide a <code>List</code> where the names of the <code>List</code> point to the assay to be updated and the elements of the <code>List</code> contain <code>DataFrame</code>s with the replacement values. If the <code>DataFrame</code> contains a column that is not present in the <code>rowData</code>, that column will get added to the <code>rowData</code>. For instance, let’s add a <code>rowData</code> variables with the mean protein expression as well as the associated standard deviation. First, we need to create the <code>DataFrame</code> with the mean expression.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="fu">assay</span><span class="op">(</span><span class="va">hl</span><span class="op">[[</span><span class="st">"proteins"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
                sd <span class="op">=</span> <span class="fu">rowSds</span><span class="op">(</span><span class="fu">assay</span><span class="op">(</span><span class="va">hl</span><span class="op">[[</span><span class="st">"proteins"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Then, we create the list and name the element <code>proteins</code> so that the new data is added to the <code>rowData</code> of the <code>proteins</code> assay. To add the list, we insert it back into the <code>rowData</code>.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rowData</span><span class="op">(</span><span class="va">hl</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/List-class.html" class="external-link">List</a></span><span class="op">(</span>proteins <span class="op">=</span> <span class="va">dF</span><span class="op">)</span></code></pre></div>
<p>As shown below, the new <code>mean</code> and <code>sd</code> variables have been added to the <code>rowData</code> of the <code>proteins</code> assay.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rowData</span><span class="op">(</span><span class="va">hl</span><span class="op">)</span><span class="op">[[</span><span class="st">"proteins"</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">## DataFrame with 1596 rows and 5 columns</span>
<span class="co">##          ProteinGroupAccessions     markers        .n      mean        sd</span>
<span class="co">##                     &lt;character&gt; &lt;character&gt; &lt;integer&gt; &lt;numeric&gt; &lt;numeric&gt;</span>
<span class="co">## A2A432                   A2A432     unknown         1         1 0.0822395</span>
<span class="co">## A2A6Q5-3               A2A6Q5-3     unknown         1         1 0.0891478</span>
<span class="co">## A2A8L5                   A2A8L5     unknown         2         1 0.1009041</span>
<span class="co">## A2AF47                   A2AF47     unknown         1         1 0.0749159</span>
<span class="co">## A2AGT5                   A2AGT5     unknown         6         1 0.1065126</span>
<span class="co">## ...                         ...         ...       ...       ...       ...</span>
<span class="co">## Q9Z2V5                   Q9Z2V5     unknown         1         1 0.0882136</span>
<span class="co">## Q9Z2W0                   Q9Z2W0     unknown         1         1 0.0565321</span>
<span class="co">## Q9Z2X1                   Q9Z2X1     unknown         1         1 0.1539930</span>
<span class="co">## Q9Z2Z9                   Q9Z2Z9     unknown         3         1 0.0930030</span>
<span class="co">## Q9Z315                   Q9Z315     unknown         1         1 0.1234534</span></code></pre>
<p>Note that you can also replace an existing column in the <code>rowData</code> by naming the column name in the <code>DataFrame</code> after the column to replace.</p>
</div>
<div class="section level1">
<h1 id="subsetting">Subsetting<a class="anchor" aria-label="anchor" href="#subsetting"></a>
</h1>
<p>One particularity of the <code>QFeatures</code> infrastructure is that the features of the constitutive assays are linked through an aggregative relation. This relation is recorded when creating new assays with <code>aggregateFeatures</code> and is exploited when subsetting <code>QFeature</code> by their feature names.</p>
<p>In the example below, we are interested in the Stat3B isoform of the Signal transducer and activator of transcription 3 (STAT3) with accession number P42227-2. This accession number corresponds to a feature name in the <em>proteins</em> assay. But this protein row was computed from 8 peptide rows in the <em>peptides</em> assay, themselves resulting from the aggregation of 8 rows in the <em>psms</em> assay.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stat3</span> <span class="op">&lt;-</span> <span class="va">hl</span><span class="op">[</span><span class="st">"P42227-2"</span>, , <span class="op">]</span>
<span class="va">stat3</span></code></pre></div>
<pre><code><span class="co">## An instance of class QFeatures containing 3 assays:</span>
<span class="co">##  [1] psms: SummarizedExperiment with 9 rows and 10 columns </span>
<span class="co">##  [2] peptides: SummarizedExperiment with 8 rows and 10 columns </span>
<span class="co">##  [3] proteins: SummarizedExperiment with 1 rows and 10 columns</span></code></pre>
<p>We can easily visualise this new <em>QFeatures</em> object using <code>ggplot2</code> once converted into a <code>data.frame</code>. See the visualization vignette for more details about data exploration from a <code>QFeatures</code> object.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stat3_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="../reference/QFeatures-class.html">longFormat</a></span><span class="op">(</span><span class="va">stat3</span><span class="op">)</span><span class="op">)</span>
<span class="va">stat3_df</span><span class="op">$</span><span class="va">assay</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">stat3_df</span><span class="op">$</span><span class="va">assay</span>,
                        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"psms"</span>, <span class="st">"peptides"</span>, <span class="st">"proteins"</span><span class="op">)</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat3_df</span>,
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">colname</span>,
           y <span class="op">=</span> <span class="va">value</span>,
           group <span class="op">=</span> <span class="va">rowname</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">assay</span><span class="op">)</span></code></pre></div>
<p><img src="QFeatures_files/figure-html/plotstat3-1.png" width="700"></p>
<p>Below we repeat the same operation for the Signal transducer and activator of transcription 1 (STAT1) and 3 (STAT3) accession numbers, namely P42227-2 and P42225. We obtain a new <code>QFeatures</code> instance containing 2 proteins, 9 peptides and 10 PSMS. From this, we can readily conclude that STAT1 was identified by a single PSM/peptide.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stat</span> <span class="op">&lt;-</span> <span class="va">hl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P42227-2"</span>, <span class="st">"P42225"</span><span class="op">)</span>, , <span class="op">]</span>
<span class="va">stat</span></code></pre></div>
<pre><code><span class="co">## An instance of class QFeatures containing 3 assays:</span>
<span class="co">##  [1] psms: SummarizedExperiment with 10 rows and 10 columns </span>
<span class="co">##  [2] peptides: SummarizedExperiment with 9 rows and 10 columns </span>
<span class="co">##  [3] proteins: SummarizedExperiment with 2 rows and 10 columns</span></code></pre>
<p>Below, we visualise the expression profiles for the two proteins.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stat_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="../reference/QFeatures-class.html">longFormat</a></span><span class="op">(</span><span class="va">stat</span><span class="op">)</span><span class="op">)</span>
<span class="va">stat_df</span><span class="op">$</span><span class="va">stat3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">stat_df</span><span class="op">$</span><span class="va">rowname</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="va">stat3_df</span><span class="op">$</span><span class="va">rowname</span>,
                        <span class="st">"STAT3"</span>, <span class="st">"STAT1"</span><span class="op">)</span>
<span class="va">stat_df</span><span class="op">$</span><span class="va">assay</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">stat_df</span><span class="op">$</span><span class="va">assay</span>,
                        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"psms"</span>, <span class="st">"peptides"</span>, <span class="st">"proteins"</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat_df</span>,
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">colname</span>,
           y <span class="op">=</span> <span class="va">value</span>,
           group <span class="op">=</span> <span class="va">rowname</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">stat3</span> <span class="op">~</span> <span class="va">assay</span><span class="op">)</span></code></pre></div>
<p><img src="QFeatures_files/figure-html/plotstat-1.png" width="700"></p>
<p>The subsetting by feature names is also available as a call to the <code>subsetByFeature</code> function, for use with the pipe operator.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span>
<span class="va">hl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="../reference/QFeatures-subsetBy.html">subsetByFeature</a></span><span class="op">(</span><span class="st">"P42227-2"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## An instance of class QFeatures containing 3 assays:</span>
<span class="co">##  [1] psms: SummarizedExperiment with 9 rows and 10 columns </span>
<span class="co">##  [2] peptides: SummarizedExperiment with 8 rows and 10 columns </span>
<span class="co">##  [3] proteins: SummarizedExperiment with 1 rows and 10 columns</span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="../reference/QFeatures-subsetBy.html">subsetByFeature</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P42227-2"</span>, <span class="st">"P42225"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## An instance of class QFeatures containing 3 assays:</span>
<span class="co">##  [1] psms: SummarizedExperiment with 10 rows and 10 columns </span>
<span class="co">##  [2] peptides: SummarizedExperiment with 9 rows and 10 columns </span>
<span class="co">##  [3] proteins: SummarizedExperiment with 2 rows and 10 columns</span></code></pre>
<p>and possibly</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="../reference/QFeatures-subsetBy.html">subsetByFeature</a></span><span class="op">(</span><span class="st">"P42227-2"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="../reference/QFeatures-class.html">longFormat</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="va">as.data.frame</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">colname</span>,
               y <span class="op">=</span> <span class="va">value</span>,
               group <span class="op">=</span> <span class="va">rowname</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">assay</span><span class="op">)</span></code></pre></div>
<p>to reproduce the line plot.</p>
</div>
<div class="section level1">
<h1 id="filtering">Filtering<a class="anchor" aria-label="anchor" href="#filtering"></a>
</h1>
<p>QFeatures is assays can also be filtered based on variables in their respective row data slots using the <code>filterFeatures</code> function. The filters can be defined using the formula interface or using <code>AnnotationFilter</code> objects from the <em><a href="https://bioconductor.org/packages/3.15/AnnotationFilter" class="external-link">AnnotationFilter</a></em> package <span class="citation">(Morgan and Rainer 2019)</span>. In addition to the pre-defined filters (such as <code>SymbolFilter</code>, <code>ProteinIdFilter</code>, … that filter on gene symbol, protein identifier, …), this package allows users to define arbitrary character or numeric filters using the <code>VariableFilter</code>.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mito_filter</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/QFeatures-filtering.html">VariableFilter</a></span><span class="op">(</span>field <span class="op">=</span> <span class="st">"markers"</span>,
                              value <span class="op">=</span> <span class="st">"Mitochondrion"</span>,
                              condition <span class="op">=</span> <span class="st">"=="</span><span class="op">)</span>
<span class="va">mito_filter</span></code></pre></div>
<pre><code><span class="co">## class: CharacterVariableFilter </span>
<span class="co">## condition: == </span>
<span class="co">## value: Mitochondrion</span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qval_filter</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/QFeatures-filtering.html">VariableFilter</a></span><span class="op">(</span>field <span class="op">=</span> <span class="st">"qValue"</span>,
                              value <span class="op">=</span> <span class="fl">0.001</span>,
                              condition <span class="op">=</span> <span class="st">"&lt;="</span><span class="op">)</span>
<span class="va">qval_filter</span></code></pre></div>
<pre><code><span class="co">## class: NumericVariableFilter </span>
<span class="co">## condition: &lt;= </span>
<span class="co">## value: 0.001</span></code></pre>
<p>These filter can then readily be applied to all assays’ row data slots. The <code>mito_filter</code> will return all PSMs, peptides and proteins that were annotated as localising to the mitochondrion.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/QFeatures-filtering.html">filterFeatures</a></span><span class="op">(</span><span class="va">hl</span>, <span class="va">mito_filter</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## An instance of class QFeatures containing 3 assays:</span>
<span class="co">##  [1] psms: SummarizedExperiment with 167 rows and 10 columns </span>
<span class="co">##  [2] peptides: SummarizedExperiment with 162 rows and 10 columns </span>
<span class="co">##  [3] proteins: SummarizedExperiment with 113 rows and 10 columns</span></code></pre>
<p>The <code>qval_filter</code>, on the other hand, will only return a subset of PSMs, because the <code>qValue</code> variable is only present in the <code>psms</code> assays. The q-values are only relevant to PSMs and that variable was dropped from the other assays.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/QFeatures-filtering.html">filterFeatures</a></span><span class="op">(</span><span class="va">hl</span>, <span class="va">qval_filter</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## An instance of class QFeatures containing 3 assays:</span>
<span class="co">##  [1] psms: SummarizedExperiment with 2466 rows and 10 columns </span>
<span class="co">##  [2] peptides: SummarizedExperiment with 0 rows and 10 columns </span>
<span class="co">##  [3] proteins: SummarizedExperiment with 0 rows and 10 columns</span></code></pre>
<p>The same filters can be created using the forumla interface:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/QFeatures-filtering.html">filterFeatures</a></span><span class="op">(</span><span class="va">hl</span>, <span class="op">~</span> <span class="va">markers</span> <span class="op">==</span> <span class="st">"Mitochondrion"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## An instance of class QFeatures containing 3 assays:</span>
<span class="co">##  [1] psms: SummarizedExperiment with 167 rows and 10 columns </span>
<span class="co">##  [2] peptides: SummarizedExperiment with 162 rows and 10 columns </span>
<span class="co">##  [3] proteins: SummarizedExperiment with 113 rows and 10 columns</span></code></pre>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/QFeatures-filtering.html">filterFeatures</a></span><span class="op">(</span><span class="va">hl</span>, <span class="op">~</span> <span class="va">qValue</span> <span class="op">&lt;=</span> <span class="fl">0.001</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## An instance of class QFeatures containing 3 assays:</span>
<span class="co">##  [1] psms: SummarizedExperiment with 2466 rows and 10 columns </span>
<span class="co">##  [2] peptides: SummarizedExperiment with 0 rows and 10 columns </span>
<span class="co">##  [3] proteins: SummarizedExperiment with 0 rows and 10 columns</span></code></pre>
</div>
<div class="section level1 unnumbered">
<h1 class="unnumbered" id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h1>
<pre><code><span class="co">## R Under development (unstable) (2021-11-16 r81199)</span>
<span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span>
<span class="co">## Running under: Ubuntu 20.04.3 LTS</span>
<span class="co">## </span>
<span class="co">## Matrix products: default</span>
<span class="co">## BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.8.so</span>
<span class="co">## </span>
<span class="co">## locale:</span>
<span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span>
<span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span>
<span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=C             </span>
<span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span>
<span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
<span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span>
<span class="co">## </span>
<span class="co">## attached base packages:</span>
<span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span>
<span class="co">## [8] base     </span>
<span class="co">## </span>
<span class="co">## other attached packages:</span>
<span class="co">##  [1] magrittr_2.0.1              ggplot2_3.3.5              </span>
<span class="co">##  [3] QFeatures_1.5.2             MultiAssayExperiment_1.21.4</span>
<span class="co">##  [5] SummarizedExperiment_1.25.3 Biobase_2.55.0             </span>
<span class="co">##  [7] GenomicRanges_1.47.5        GenomeInfoDb_1.31.1        </span>
<span class="co">##  [9] IRanges_2.29.1              S4Vectors_0.33.8           </span>
<span class="co">## [11] BiocGenerics_0.41.2         MatrixGenerics_1.7.0       </span>
<span class="co">## [13] matrixStats_0.61.0          BiocStyle_2.23.0           </span>
<span class="co">## </span>
<span class="co">## loaded via a namespace (and not attached):</span>
<span class="co">##  [1] sass_0.4.0              jsonlite_1.7.2          bslib_0.3.1            </span>
<span class="co">##  [4] BiocManager_1.30.16     highr_0.9               GenomeInfoDbData_1.2.7 </span>
<span class="co">##  [7] yaml_2.2.1              pillar_1.6.4            lattice_0.20-45        </span>
<span class="co">## [10] glue_1.5.1              digest_0.6.29           XVector_0.35.0         </span>
<span class="co">## [13] colorspace_2.0-2        htmltools_0.5.2         Matrix_1.3-4           </span>
<span class="co">## [16] pkgconfig_2.0.3         bookdown_0.24           zlibbioc_1.41.0        </span>
<span class="co">## [19] purrr_0.3.4             scales_1.1.1            tibble_3.1.6           </span>
<span class="co">## [22] generics_0.1.1          farver_2.1.0            AnnotationFilter_1.19.0</span>
<span class="co">## [25] ellipsis_0.3.2          cachem_1.0.6            withr_2.4.3            </span>
<span class="co">## [28] lazyeval_0.2.2          crayon_1.4.2            memoise_2.0.1          </span>
<span class="co">## [31] evaluate_0.14           fs_1.5.2                fansi_0.5.0            </span>
<span class="co">## [34] MASS_7.3-54             textshaping_0.3.6       tools_4.2.0            </span>
<span class="co">## [37] lifecycle_1.0.1         stringr_1.4.0           munsell_0.5.0          </span>
<span class="co">## [40] cluster_2.1.2           DelayedArray_0.21.2     compiler_4.2.0         </span>
<span class="co">## [43] pkgdown_2.0.1.9000      jquerylib_0.1.4         systemfonts_1.0.3      </span>
<span class="co">## [46] rlang_0.4.12            grid_4.2.0              RCurl_1.98-1.5         </span>
<span class="co">## [49] MsCoreUtils_1.7.2       igraph_1.2.9            bitops_1.0-7           </span>
<span class="co">## [52] labeling_0.4.2          rmarkdown_2.11          gtable_0.3.0           </span>
<span class="co">## [55] R6_2.5.1                knitr_1.36              dplyr_1.0.7            </span>
<span class="co">## [58] fastmap_1.1.0           utf8_1.2.2              clue_0.3-60            </span>
<span class="co">## [61] rprojroot_2.0.2         ragg_1.2.1              ProtGenerics_1.27.0    </span>
<span class="co">## [64] desc_1.4.0              stringi_1.7.6           vctrs_0.3.8            </span>
<span class="co">## [67] tidyselect_1.1.1        xfun_0.28</span></code></pre>
</div>
<div class="section level1 unnumbered">
<h1 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Christoforou:2016" class="csl-entry">
Christoforou, Andy, Claire M Mulvey, Lisa M Breckels, Aikaterini Geladaki, Tracey Hurrell, Penelope C Hayward, Thomas Naake, et al. 2016. <span>“A Draft Map of the Mouse Pluripotent Stem Cell Spatial Proteome.”</span> <em>Nat Commun</em> 7: 8992. <a href="https://doi.org/10.1038/ncomms9992" class="external-link">https://doi.org/10.1038/ncomms9992</a>.
</div>
<div id="ref-SE" class="csl-entry">
Morgan, Martin, Valerie Obenchain, Jim Hester, and Hervé Pagès. 2019. <em><span>SummarizedExperiment</span>: <span>SummarizedExperiment</span> Container</em>.
</div>
<div id="ref-AnnotationFilter" class="csl-entry">
Morgan, Martin, and Johannes Rainer. 2019. <em><span>AnnotationFilter</span>: Facilities for Filtering <span>Bioconductor</span> Annotation Resources</em>. <a href="https://github.com/Bioconductor/AnnotationFilter" class="external-link">https://github.com/Bioconductor/AnnotationFilter</a>.
</div>
<div id="ref-Ramos:2017" class="csl-entry">
Ramos, Marcel, Lucas Schiffer, Angela Re, Rimsha Azhar, Azfar Basunia, Carmen Rodriguez Cabrera, Tiffany Chan, et al. 2017. <span>“Software for the Integration of Multi-Omics Experiments in <span>Bioconductor</span>.”</span> <em>Cancer Research</em> 77(21); e39-42.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Laurent Gatto, Christophe Vanderaa.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
